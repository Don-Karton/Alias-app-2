<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alias Game - DiSpace</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        /* Лоадер */
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            color: white;
        }

        .loader-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        .loader-progress {
            width: 200px;
            height: 4px;
            background: rgba(255,255,255,0.3);
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .loader-progress-bar {
            height: 100%;
            background: white;
            border-radius: 2px;
            width: 0%;
            animation: progress 2s ease-in-out;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes progress {
            0% { width: 0%; }
            100% { width: 100%; }
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 10px;
            min-height: 100vh;
        }

        .page {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            animation: fadeIn 0.3s ease-in;
            min-height: calc(100vh - 20px);
            position: relative;
        }

        .page.active {
            display: block;
        }

        /* Кнопка звука на всех страницах */
        .sound-toggle-global {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            background: rgba(102, 126, 234, 0.9);
            color: white;
            font-size: 20px;
            cursor: pointer;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .sound-toggle-global:hover {
            background: rgba(102, 126, 234, 1);
            transform: scale(1.1);
        }

        .sound-toggle-global.muted {
            background: rgba(244, 67, 54, 0.9);
        }

        /* Шапка игрового экрана */
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            margin-bottom: 20px;
            color: white;
        }

        .game-score {
            font-size: 18px;
            font-weight: 600;
        }

        .game-controls {
            display: flex;
            gap: 10px;
        }

        .control-btn {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            color: white;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .control-btn.muted {
            background: rgba(255,0,0,0.6);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1, h2 {
            text-align: center;
            margin-bottom: 30px;
            color: #667eea;
        }

        h1 {
            font-size: clamp(24px, 6vw, 32px);
        }

        h2 {
            font-size: clamp(20px, 5vw, 24px);
        }

        .menu-button {
            display: block;
            width: 100%;
            padding: 18px;
            margin: 10px 0;
            border: none;
            border-radius: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: clamp(16px, 4vw, 18px);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
        }

        .menu-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .menu-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .team-list {
            margin: 20px 0;
        }

        .team-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            margin: 10px 0;
            background: #f7f7f7;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
        }

        .team-item:hover {
            background: #e9e9e9;
        }

        .team-name {
            font-size: clamp(16px, 4vw, 18px);
            font-weight: 500;
        }

        .team-score {
            font-size: clamp(20px, 5vw, 24px);
            font-weight: bold;
            color: #667eea;
        }

        .add-team-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            margin: 20px auto;
            border: 3px dashed #667eea;
            border-radius: 50%;
            background: white;
            color: #667eea;
            font-size: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
        }

        .add-team-btn:hover {
            background: #667eea;
            color: white;
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .category-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            background: white;
            font-size: clamp(14px, 3vw, 16px);
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
            min-height: 100px;
            position: relative;
        }

        .category-btn:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .category-btn.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .category-icon {
            font-size: 28px;
            margin-bottom: 8px;
        }

        .category-tooltip {
            font-size: 12px;
            opacity: 0.7;
            text-align: center;
            margin-top: 5px;
        }

        .settings-group {
            margin: 20px 0;
        }

        .settings-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            font-size: clamp(14px, 3vw, 16px);
        }

        .settings-group input[type="number"],
        .settings-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: clamp(14px, 3vw, 16px);
        }

        .checkbox-group {
            display: flex;
            align-items: flex-start;
            margin: 15px 0;
            gap: 10px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            min-width: 20px;
            margin-top: 2px;
        }

        .checkbox-group label {
            font-size: clamp(14px, 3vw, 16px);
            margin: 0;
        }

        /* Игровое поле */
        .game-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 40vh;
            position: relative;
            margin: 20px 0;
        }

        .game-card {
            position: relative;
            width: min(300px, 80vw);
            height: min(300px, 30vh);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: clamp(24px, 6vw, 36px);
            font-weight: bold;
            cursor: grab;
            user-select: none;
            transition: transform 0.2s ease;
            touch-action: none;
            text-align: center;
            padding: 20px;
        }

        .game-card.dragging {
            cursor: grabbing;
        }

        .swipe-indicators {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            border-radius: 20px;
            overflow: hidden;
        }

        .swipe-indicator {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            font-weight: bold;
        }

        .swipe-indicator.left {
            background: rgba(255,0,0,0.3);
            color: #ff6b6b;
        }

        .swipe-indicator.right {
            background: rgba(0,255,0,0.3);
            color: #51cf66;
        }

        .swipe-indicator.active {
            opacity: 1;
        }

        /* Таймер внизу экрана */
        .game-timer {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: min(200px, 50vw);
            height: 80px;
            background: rgba(255,255,255,0.9);
            border-radius: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(32px, 8vw, 48px);
            font-weight: bold;
            color: #667eea;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 100;
        }

        .game-timer.warning {
            background: rgba(255,193,7,0.9);
            color: #dc3545;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.1); }
        }

        .results-list {
            margin: 20px 0;
            max-height: 40vh;
            overflow-y: auto;
        }

        .word-result {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 8px 0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
        }

        .word-result.correct {
            background: #4caf50;
            color: white;
        }

        .word-result.incorrect {
            background: #f44336;
            color: white;
        }

        .word-result:active {
            transform: scale(0.98);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            padding: 20px;
            background: #f7f7f7;
            border-radius: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: clamp(28px, 7vw, 36px);
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: clamp(12px, 3vw, 14px);
            color: #666;
            margin-top: 5px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 400px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-content h3 {
            margin-bottom: 20px;
            color: #667eea;
        }

        .modal-content input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-buttons button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            touch-action: manipulation;
        }

        .modal-buttons .save {
            background: #667eea;
            color: white;
        }

        .modal-buttons .delete {
            background: #f44336;
            color: white;
        }

        .modal-buttons .cancel {
            background: #e0e0e0;
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px 20px;
            background: #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
            font-size: clamp(14px, 3vw, 16px);
        }

        .back-button:hover {
            background: #d0d0d0;
        }

        .qr-code {
            width: min(200px, 60vw);
            height: min(200px, 60vw);
            margin: 20px auto;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            font-size: clamp(14px, 3vw, 16px);
        }

        /* Настройки звука */
        .sound-settings {
            margin: 20px 0;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 15px 0;
        }

        .volume-control label {
            min-width: 120px;
            font-size: clamp(14px, 3vw, 16px);
        }

        .volume-control input[type="range"] {
            flex: 1;
            height: 6px;
        }

        .volume-control .volume-value {
            min-width: 40px;
            text-align: right;
            font-weight: bold;
        }

        /* О приложении в главном меню */
        .main-menu-about {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            color: #666;
            font-size: clamp(12px, 3vw, 14px);
            line-height: 1.6;
        }

        .main-menu-about h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: clamp(16px, 4vw, 18px);
        }

        .main-menu-about p {
            margin-bottom: 10px;
        }

        /* Адаптивность */
        @media (max-width: 480px) {
            .container {
                padding: 5px;
            }
            
            .page {
                padding: 15px;
                border-radius: 10px;
                min-height: calc(100vh - 10px);
            }
            
            .category-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .category-btn {
                padding: 15px 10px;
                min-height: 80px;
            }
            
            .game-card {
                width: 90vw;
                height: 25vh;
            }

            .sound-toggle-global {
                top: 10px;
                right: 10px;
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
        }

        @media (max-height: 600px) {
            .game-area {
                height: 30vh;
            }
            
            .game-card {
                height: 20vh;
            }
        }
    </style>
</head>
<body>
    <!-- Кнопка звука на всех страницах -->
    <button class="sound-toggle-global" id="globalSoundToggle" onclick="toggleGlobalSound()">🔊</button>

    <!-- Лоадер -->
    <div id="loader" class="loader">
        <div class="loader-spinner"></div>
        <div class="loader-progress">
            <div class="loader-progress-bar"></div>
        </div>
        <div>Загрузка Alias Game...</div>
    </div>

    <div class="container">
        <!-- Главное меню -->
        <div id="mainMenu" class="page">
            <h1>Alias Game</h1>
            <button class="menu-button" onclick="startNewGame()">🎮 Новая игра</button>
            <button class="menu-button" id="continueBtn" disabled>⏯️ Продолжить игру</button>
            <button class="menu-button" onclick="showPage('soundSettings')">🔊 Настройки звука</button>
            <button class="menu-button" onclick="showPage('dispace')">🚀 DiSpace</button>
            <button class="menu-button" onclick="showPage('ratings')">🏆 Рейтинги</button>
            <button class="menu-button" onclick="showPage('partnerTasks')">🎯 Задания от партнеров</button>
            <button class="menu-button" onclick="showPage('rewards')">🎁 Награды</button>
            <button class="menu-button" onclick="showPage('rules')">📖 Правила</button>
            
            <!-- О приложении внизу -->
            <div class="main-menu-about">
                <h3>О приложении</h3>
                <p>Alias Game - увлекательная командная игра, где нужно объяснять слова, не называя их напрямую.</p>
                <p>Играйте с друзьями, зарабатывайте награды и участвуйте в турнирах!</p>
                <p><strong>Версия:</strong> 2.0.1</p>
                <p><strong>Разработчик:</strong> © 2024 DiSpace</p>
            </div>
        </div>

        <!-- Настройка команд -->
        <div id="teamSetup" class="page">
            <div class="back-button" onclick="showPage('mainMenu')">← Назад</div>
            <h2>Настройка команд</h2>
            <div id="teamList" class="team-list"></div>
            <div class="add-team-btn" onclick="addTeam()">+</div>
            <button class="menu-button" onclick="showPage('categorySelect')">Далее →</button>
        </div>

        <!-- Выбор категорий -->
        <div id="categorySelect" class="page">
            <div class="back-button" onclick="showPage('teamSetup')">← Назад</div>
            <h2>Выбор категорий</h2>
            <h3>Сложность</h3>
            <div class="category-grid">
                <button class="category-btn" data-type="difficulty" data-value="easy">
                    <div class="category-icon">🟢</div>
                    <div>Легкий</div>
                    <div class="category-tooltip">Простые слова</div>
                </button>
                <button class="category-btn" data-type="difficulty" data-value="medium">
                    <div class="category-icon">🟡</div>
                    <div>Средний</div>
                    <div class="category-tooltip">Обычная сложность</div>
                </button>
                <button class="category-btn" data-type="difficulty" data-value="hard">
                    <div class="category-icon">🟠</div>
                    <div>Сложный</div>
                    <div class="category-tooltip">Сложные слова</div>
                </button>
                <button class="category-btn" data-type="difficulty" data-value="extreme">
                    <div class="category-icon">🔴</div>
                    <div>Гиперсложный</div>
                    <div class="category-tooltip">Очень сложно!</div>
                </button>
            </div>
            <h3>Темы</h3>
            <div class="category-grid">
                <button class="category-btn" data-type="theme" data-value="cities">
                    <div class="category-icon">🏙️</div>
                    <div>Города</div>
                    <div class="category-tooltip">Города мира</div>
                </button>
                <button class="category-btn" data-type="theme" data-value="capitals">
                    <div class="category-icon">🏛️</div>
                    <div>Столицы</div>
                    <div class="category-tooltip">Столицы стран</div>
                </button>
                <button class="category-btn" data-type="theme" data-value="general">
                    <div class="category-icon">📚</div>
                    <div>Общие слова</div>
                    <div class="category-tooltip">Разные темы</div>
                </button>
                <button class="category-btn" data-type="theme" data-value="harry_potter">
                    <div class="category-icon">⚡</div>
                    <div>Гарри Поттер</div>
                    <div class="category-tooltip">Мир магии</div>
                </button>
                <button class="category-btn" data-type="theme" data-value="lotr">
                    <div class="category-icon">💍</div>
                    <div>Властелин колец</div>
                    <div class="category-tooltip">Средиземье</div>
                </button>
                <button class="category-btn" data-type="theme" data-value="celebrities">
                    <div class="category-icon">⭐</div>
                    <div>Знаменитости</div>
                    <div class="category-tooltip">Известные люди</div>
                </button>
                <button class="category-btn" data-type="theme" data-value="tech">
                    <div class="category-icon">💻</div>
                    <div>Технологии</div>
                    <div class="category-tooltip">IT и гаджеты</div>
                </button>
                <button class="category-btn" data-type="theme" data-value="science">
                    <div class="category-icon">🔬</div>
                    <div>Наука</div>
                    <div class="category-tooltip">Научные термины</div>
                </button>
            </div>
            <button class="menu-button" onclick="showPage('gameSettings')">Далее →</button>
        </div>

        <!-- Настройки игры -->
        <div id="gameSettings" class="page">
            <div class="back-button" onclick="showPage('categorySelect')">← Назад</div>
            <h2>Настройки игры</h2>
            <div class="settings-group">
                <label>Время раунда (сек)</label>
                <input type="number" id="roundTime" value="60" min="30" max="180">
            </div>
            <div class="settings-group">
                <label>Минимальное количество очков для победы</label>
                <input type="number" id="winScore" value="30" min="10" max="100">
            </div>
            <div class="checkbox-group">
                <input type="checkbox" id="skipPenalty">
                <label for="skipPenalty">Штраф за пропуск слова (-1 очко)</label>
            </div>
            <div class="settings-group">
                <label>Ставка (монеты)</label>
                <input type="number" id="betAmount" value="0" min="0">
            </div>
            <button class="menu-button" onclick="startGame()">🎮 Начать игру</button>
        </div>

        <!-- Игровой экран -->
        <div id="gameScreen" class="page" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 0;">
            <div class="game-header">
                <div class="game-score" id="headerScore">Очки: 0</div>
                <div class="game-controls">
                    <button class="control-btn" onclick="pauseGame()">⏸️</button>
                    <button class="control-btn" onclick="exitToMenu()">🏠</button>
                </div>
            </div>
            
            <div class="current-team" id="currentTeam" style="text-align: center; font-size: 20px; color: white; margin: 20px 0;">Команда 1</div>
            
            <div class="game-area">
                <div class="game-card" id="gameCard">
                    <div class="swipe-indicators">
                        <div class="swipe-indicator left">❌</div>
                        <div class="swipe-indicator right">✅</div>
                    </div>
                    <span id="cardText">Готов?</span>
                </div>
            </div>

            <div class="game-timer" id="gameTimer">60</div>
        </div>

        <!-- Промежуточные результаты -->
        <div id="roundResults" class="page">
            <h2>Результаты раунда</h2>
            <div id="resultsList" class="results-list"></div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="correctCount">0</div>
                    <div class="stat-label">Угадано</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="incorrectCount">0</div>
                    <div class="stat-label">Пропущено</div>
                </div>
            </div>
            <button class="menu-button" onclick="nextRound()">Далее →</button>
        </div>

        <!-- Финальные результаты -->
        <div id="finalResults" class="page">
            <h2>🎉 Игра окончена!</h2>
            <h1 id="winnerName">Победитель</h1>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="finalScore">0</div>
                    <div class="stat-label">Очков набрано</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="prizeAmount">0</div>
                    <div class="stat-label">Призовой фонд</div>
                </div>
            </div>
            <div class="qr-code">
                <span>QR-код награды</span>
            </div>
            <button class="menu-button" onclick="showPage('mainMenu')">🏠 В главное меню</button>
        </div>

        <!-- Настройки звука -->
        <div id="soundSettings" class="page">
            <div class="back-button" onclick="showPage('mainMenu')">← Назад</div>
            <h2>Настройки звука</h2>
            <div class="sound-settings">
                <div class="volume-control">
                    <label>Общая громкость:</label>
                    <input type="range" id="masterVolume" min="0" max="100" value="70">
                    <span class="volume-value" id="masterVolumeValue">70%</span>
                </div>
                <div class="volume-control">
                    <label>Звуки кнопок:</label>
                    <input type="range" id="buttonVolume" min="0" max="100" value="50">
                    <span class="volume-value" id="buttonVolumeValue">50%</span>
                </div>
                <div class="volume-control">
                    <label>Звук таймера:</label>
                    <input type="range" id="timerVolume" min="0" max="100" value="80">
                    <span class="volume-value" id="timerVolumeValue">80%</span>
                </div>
                <div class="volume-control">
                    <label>Игровые эффекты:</label>
                    <input type="range" id="effectsVolume" min="0" max="100" value="60">
                    <span class="volume-value" id="effectsVolumeValue">60%</span>
                </div>
            </div>
            <button class="menu-button" onclick="testSounds()">🔊 Тест звуков</button>
        </div>

        <!-- DiSpace -->
        <div id="dispace" class="page">
            <div class="back-button" onclick="showPage('mainMenu')">← Назад</div>
            <h2>DiSpace</h2>
            <p>DiSpace - цифровая экосистема для бизнеса и развлечений. Объединяем лучшие сервисы в единое пространство:</p>
            <ul style="margin: 20px; line-height: 2; padding-left: 20px;">
                <li>Digital Bar</li>
                <li>Game Bar</li>
                <li>Digital Hotel</li>
                <li>Digital Cafe</li>
                <li>Digital Trip</li>
                <li>Digital Music</li>
                <li>Digital Sharing</li>
                <li>Digital Health</li>
                <li>Digital Delivery</li>
            </ul>
        </div>

        <!-- Рейтинги -->
        <div id="ratings" class="page">
            <div class="back-button" onclick="showPage('mainMenu')">← Назад</div>
            <h2>Рейтинги</h2>
            <div id="ratingsList">
                <p>Рейтинги игроков будут отображаться здесь после первых игр.</p>
            </div>
        </div>

        <!-- Задания от партнеров -->
        <div id="partnerTasks" class="page">
            <div class="back-button" onclick="showPage('mainMenu')">← Назад</div>
            <h2>Задания от партнеров</h2>
            <p>Эксклюзивные сценарии игры от наших партнеров появятся здесь скоро!</p>
        </div>

        <!-- Награды -->
        <div id="rewards" class="page">
            <div class="back-button" onclick="showPage('mainMenu')">← Назад</div>
            <h2>Мои награды</h2>
            <p>Здесь будут отображаться ваши достижения и награды.</p>
        </div>

        <!-- Правила -->
        <div id="rules" class="page">
            <div class="back-button" onclick="showPage('mainMenu')">← Назад</div>
            <h2>Правила игры</h2>
            <p><strong>Цель игры:</strong> Объяснить как можно больше слов своей команде за отведенное время.</p>
            <p style="margin: 20px 0;"><strong>Как играть:</strong></p>
            <ol style="margin: 20px; line-height: 2; padding-left: 20px;">
                <li>Разделитесь на команды</li>
                <li>Выберите категории слов и сложность</li>
                <li>Объясняйте слова, не называя их и однокоренные слова</li>
                <li>Свайп вправо - слово угадано (+1 очко)</li>
                <li>Свайп влево - пропустить слово</li>
                <li>Побеждает команда, набравшая больше всех очков, но не менее установленного минимума</li>
            </ol>
        </div>

        <!-- Модальное окно для редактирования команды -->
        <div id="teamModal" class="modal">
            <div class="modal-content">
                <h3>Редактировать команду</h3>
                <input type="text" id="teamNameInput" placeholder="Название команды">
                <div class="modal-buttons">
                    <button class="save" onclick="saveTeamName()">Сохранить</button>
                    <button class="delete" onclick="deleteTeam()">Удалить</button>
                    <button class="cancel" onclick="closeModal()">Отмена</button>
                </div>
            </div>
        </div>

        <!-- Модальное окно паузы -->
        <div id="pauseModal" class="modal">
            <div class="modal-content">
                <h3>Игра приостановлена</h3>
                <button class="menu-button" onclick="resumeGame()">▶️ Продолжить</button>
                <button class="menu-button" onclick="exitToMenuConfirm()">🏠 В главное меню</button>
            </div>
        </div>
    </div>

    <script>
        // Глобальные переменные
        let teams = [];
        let currentTeamIndex = 0;
        let currentWord = '';
        let timer = null;
        let timeLeft = 60;
        let gameWords = [];
        let roundWords = { correct: [], incorrect: [] };
        let gameSettings = {};
        let currentEditingTeam = null;
        let isDragging = false;
        let startX = 0;
        let currentX = 0;
        let isPaused = false;
        let gameEnded = false;
        let soundSettings = {
            master: 70,
            buttons: 50,
            timer: 80,
            effects: 60,
            enabled: true
        };

        // Расширенные словари слов (100+ слов в каждой категории)
        const wordDictionaries = {
            easy: {
                general: ['стол', 'стул', 'дом', 'кот', 'собака', 'дерево', 'солнце', 'луна', 'вода', 'огонь', 'книга', 'ручка', 'телефон', 'компьютер', 'машина', 'автобус', 'поезд', 'самолет', 'корабль', 'велосипед', 'часы', 'зеркало', 'окно', 'дверь', 'стена', 'пол', 'потолок', 'крыша', 'лестница', 'лифт', 'магазин', 'школа', 'больница', 'театр', 'кино', 'парк', 'река', 'озеро', 'море', 'гора', 'лес', 'поле', 'сад', 'цветок', 'трава', 'листья', 'ветка', 'корень', 'камень', 'песок', 'снег', 'лед', 'дождь', 'ветер', 'облако', 'звезда', 'планета', 'земля', 'небо', 'день', 'ночь', 'утро', 'вечер', 'год', 'месяц', 'неделя', 'час', 'минута', 'секунда', 'хлеб', 'молоко', 'мясо', 'рыба', 'овощи', 'фрукты', 'сыр', 'масло', 'соль', 'сахар', 'мед', 'чай', 'кофе', 'вода', 'сок', 'вино', 'пиво', 'еда', 'завтрак', 'обед', 'ужин', 'тарелка', 'чашка', 'ложка', 'вилка', 'нож', 'стакан', 'бутылка', 'кастрюля', 'сковорода', 'плита', 'холодильник', 'мебель', 'кровать', 'диван', 'шкаф', 'полка'],
                cities: ['Москва', 'Санкт-Петербург', 'Новосибирск', 'Екатеринбург', 'Казань', 'Нижний Новгород', 'Челябинск', 'Самара', 'Омск', 'Ростов-на-Дону', 'Уфа', 'Красноярск', 'Воронеж', 'Пермь', 'Волгоград', 'Краснодар', 'Саратов', 'Тюмень', 'Тольятти', 'Ижевск', 'Барнаул', 'Ульяновск', 'Иркутск', 'Хабаровск', 'Ярославль', 'Владивосток', 'Махачкала', 'Томск', 'Оренбург', 'Кемерово', 'Новокузнецк', 'Рязань', 'Пенза', 'Астрахань', 'Липецк', 'Тула', 'Киров', 'Чебоксары', 'Курск', 'Брянск', 'Магнитогорск', 'Иваново', 'Тверь', 'Ставрополь', 'Белгород', 'Сочи', 'Нижний Тагил', 'Архангельск', 'Владимир', 'Калининград', 'Чита', 'Калуга', 'Сургут', 'Смоленск', 'Волжский', 'Курган', 'Орел', 'Череповец', 'Вологда', 'Подольск', 'Саранск', 'Петрозаводск', 'Йошкар-Ола', 'Мурманск', 'Тамбов', 'Стерлитамак', 'Грозный', 'Кострома', 'Благовещенск', 'Комсомольск-на-Амуре', 'Петропавловск-Камчатский', 'Великий Новгород', 'Псков', 'Энгельс', 'Балашиха', 'Химки', 'Королев', 'Мытищи', 'Люберцы', 'Красногорск', 'Электросталь', 'Коломна', 'Одинцово', 'Жуковский', 'Серпухов', 'Щелково', 'Орехово-Зуево', 'Домодедово', 'Раменское', 'Дзержинский', 'Пушкино', 'Реутов', 'Долгопрудный', 'Видное', 'Ивантеевка', 'Сергиев Посад', 'Истра', 'Фрязино', 'Лобня', 'Клин', 'Воскресенск', 'Дубна', 'Егорьевск', 'Ногинск', 'Павловский Посад'],
                capitals: ['Москва', 'Вашингтон', 'Лондон', 'Париж', 'Берлин', 'Рим', 'Мадрид', 'Лиссабон', 'Амстердам', 'Брюссель', 'Вена', 'Берн', 'Стокгольм', 'Осло', 'Копенгаген', 'Хельсинки', 'Варшава', 'Прага', 'Братислава', 'Будапешт', 'Любляна', 'Загреб', 'Белград', 'Скопье', 'Тирана', 'Подгорица', 'Сараево', 'София', 'Бухарест', 'Кишинев', 'Киев', 'Минск', 'Вильнюс', 'Рига', 'Таллин', 'Рейкьявик', 'Дублин', 'Лондон', 'Афины', 'Никосия', 'Валлетта', 'Анкара', 'Тбилиси', 'Ереван', 'Баку', 'Астана', 'Ташкент', 'Бишкек', 'Душанбе', 'Ашхабад', 'Кабул', 'Тегеран', 'Исламабад', 'Нью-Дели', 'Коломбо', 'Катманду', 'Тхимпху', 'Дакка', 'Янгон', 'Бангкок', 'Ханой', 'Вьентьян', 'Пномпень', 'Куала-Лумпур', 'Сингапур', 'Джакарта', 'Дили', 'Манила', 'Токио', 'Сеул', 'Пхеньян', 'Пекин', 'Улан-Батор', 'Каир', 'Триполи', 'Тунис', 'Алжир', 'Рабат', 'Нуакшот', 'Дакар', 'Бамако', 'Уагадугу', 'Ниамей', 'Абуджа', 'Нджамена', 'Банги', 'Яунде', 'Малабо', 'Либревиль', 'Браззавиль', 'Киншаса', 'Луанда', 'Виндхук', 'Габороне', 'Претория', 'Масеру', 'Мбабане', 'Мапуту', 'Антананариву', 'Порт-Луи', 'Виктория', 'Морони', 'Найроби', 'Кампала', 'Кигали', 'Бужумбура', 'Додома', 'Лилонгве', 'Лусака', 'Хараре'],
                tech: ['компьютер', 'телефон', 'смартфон', 'планшет', 'ноутбук', 'интернет', 'сайт', 'приложение', 'программа', 'код', 'клавиатура', 'мышь', 'монитор', 'экран', 'принтер', 'сканер', 'камера', 'микрофон', 'колонки', 'наушники', 'флешка', 'диск', 'файл', 'папка', 'документ', 'фото', 'видео', 'музыка', 'игра', 'браузер', 'поиск', 'почта', 'сообщение', 'чат', 'звонок', 'связь', 'сеть', 'WiFi', 'Bluetooth', 'USB', 'зарядка', 'батарея', 'память', 'процессор', 'софт', 'обновление', 'вирус', 'пароль', 'логин', 'аккаунт', 'профиль', 'настройки', 'меню', 'кнопка', 'ссылка', 'загрузка', 'установка', 'удаление', 'копирование', 'вставка', 'сохранение', 'открытие', 'закрытие', 'запуск', 'остановка', 'пауза', 'воспроизведение', 'запись', 'редактирование', 'форматирование', 'конвертация', 'сжатие', 'архив', 'резервная копия', 'восстановление', 'синхронизация', 'обмен', 'передача', 'получение', 'отправка', 'публикация', 'скачивание', 'стрим', 'онлайн', 'офлайн', 'облако', 'сервер', 'хостинг', 'домен', 'протокол', 'алгоритм', 'база данных', 'таблица', 'запрос', 'ответ', 'ошибка', 'отладка', 'тестирование', 'версия', 'релиз', 'бета', 'альфа', 'патч', 'фикс', 'баг', 'фича', 'функция', 'метод', 'класс', 'объект']
            },
            medium: {
                general: ['абстракция', 'амбиция', 'анализ', 'аргумент', 'атмосфера', 'баланс', 'барьер', 'вдохновение', 'взаимодействие', 'влияние', 'воображение', 'восприятие', 'гармония', 'гипотеза', 'дилемма', 'дисциплина', 'достижение', 'единство', 'жертва', 'забота', 'зависимость', 'инициатива', 'инновация', 'интуиция', 'исследование', 'качество', 'компромисс', 'конкуренция', 'концентрация', 'координация', 'критика', 'лидерство', 'логика', 'любопытство', 'мотивация', 'наблюдение', 'независимость', 'обязательство', 'ответственность', 'отношение', 'планирование', 'подход', 'поддержка', 'понимание', 'преимущество', 'принцип', 'проблема', 'прогресс', 'развитие', 'решение', 'самоконтроль', 'синтез', 'сотрудничество', 'стандарт', 'стратегия', 'структура', 'творчество', 'теория', 'терпение', 'технология', 'традиция', 'уважение', 'управление', 'усилие', 'философия', 'фокус', 'характер', 'целостность', 'ценность', 'эмоция', 'энергия', 'энтузиазм', 'этика', 'эффективность', 'адаптация', 'альтернатива', 'амплитуда', 'антагонизм', 'апатия', 'аспект', 'ассоциация', 'биография', 'благодарность', 'великодушие', 'вероятность', 'взгляд', 'воля', 'впечатление', 'выносливость', 'гениальность', 'гибкость', 'глубина', 'готовность', 'деликатность', 'дипломатия', 'доверие', 'доказательство', 'драма', 'духовность', 'желание', 'жизнеспособность', 'заинтересованность', 'закономерность', 'зрелость', 'идеал', 'импульс', 'индивидуальность', 'инстинкт', 'интеллект', 'искренность', 'капризность', 'компетентность'],
                celebrities: ['Пушкин', 'Толстой', 'Достоевский', 'Чехов', 'Гоголь', 'Лермонтов', 'Тургенев', 'Некрасов', 'Крылов', 'Фонвизин', 'Грибоедов', 'Островский', 'Салтыков-Щедрин', 'Бунин', 'Куприн', 'Горький', 'Маяковский', 'Есенин', 'Блок', 'Ахматова', 'Цветаева', 'Пастернак', 'Мандельштам', 'Бродский', 'Солженицын', 'Набоков', 'Булгаков', 'Платонов', 'Шолохов', 'Твардовский', 'Симонов', 'Фадеев', 'Паустовский', 'Пришвин', 'Бианки', 'Чуковский', 'Маршак', 'Барто', 'Михалков', 'Носов', 'Драгунский', 'Заходер', 'Успенский', 'Волков', 'Гайдар', 'Катаев', 'Житков', 'Рыбаков', 'Железников', 'Крапивин', 'Эйнштейн', 'Ньютон', 'Дарвин', 'Галилей', 'Коперник', 'Кеплер', 'Менделеев', 'Ломоносов', 'Павлов', 'Сеченов', 'Мечников', 'Тимирязев', 'Вернадский', 'Капица', 'Ландау', 'Сахаров', 'Королев', 'Циолковский', 'Жуковский', 'Туполев', 'Яковлев', 'Микоян', 'Ильюшин', 'Антонов', 'Шекспир', 'Данте', 'Гете', 'Сервантес', 'Мольер', 'Вольтер', 'Руссо', 'Дидро', 'Байрон', 'Гюго', 'Бальзак', 'Стендаль', 'Флобер', 'Золя', 'Мопассан', 'Пруст', 'Камю', 'Сартр', 'Диккенс', 'Теккерей', 'Стивенсон', 'Конан Дойл', 'Киплинг', 'Уэллс', 'Шоу', 'Уайльд', 'Джойс', 'Лоуренс', 'Хемингуэй', 'Фолкнер', 'Стейнбек', 'Фицджеральд', 'Лондон', 'Твен', 'Мелвилл', 'Уитмен'],
                science: ['гравитация', 'эволюция', 'фотосинтез', 'атом', 'молекула', 'энергия', 'электричество', 'магнетизм', 'радиация', 'квант', 'фотон', 'электрон', 'протон', 'нейтрон', 'ядро', 'изотоп', 'элемент', 'соединение', 'реакция', 'катализ', 'окисление', 'восстановление', 'кислота', 'основание', 'соль', 'раствор', 'концентрация', 'давление', 'температура', 'теплота', 'энтропия', 'энтальпия', 'кинетика', 'термодинамика', 'механика', 'динамика', 'статика', 'кинематика', 'колебания', 'волны', 'оптика', 'акустика', 'электродинамика', 'квантовая механика', 'теория относительности', 'астрофизика', 'космология', 'планета', 'звезда', 'галактика', 'вселенная', 'черная дыра', 'нейтронная звезда', 'пульсар', 'квазар', 'комета', 'астероид', 'метеор', 'метеорит', 'орбита', 'гравитационное поле', 'магнитное поле', 'электрическое поле', 'электромагнитное излучение', 'спектр', 'частота', 'длина волны', 'амплитуда', 'фаза', 'интерференция', 'дифракция', 'поляризация', 'рефракция', 'отражение', 'преломление', 'дисперсия', 'биология', 'анатомия', 'физиология', 'генетика', 'ДНК', 'РНК', 'белок', 'фермент', 'гормон', 'витамин', 'клетка', 'ткань', 'орган', 'система', 'организм', 'популяция', 'экосистема', 'биосфера', 'наследственность', 'изменчивость', 'мутация', 'отбор', 'адаптация', 'видообразование', 'экология', 'охрана природы', 'биоразнообразие', 'вымирание', 'селекция', 'гибридизация']
            },
            hard: {
                general: ['парадокс', 'абстракция', 'концепция', 'философия', 'метафора', 'аллегория', 'символизм', 'метонимия', 'синекдоха', 'оксюморон', 'антитеза', 'гипербола', 'литота', 'ирония', 'сарказм', 'эвфемизм', 'дисфемизм', 'анафора', 'эпифора', 'хиазм', 'аллитерация', 'ассонанс', 'ономатопея', 'паронимия', 'омонимия', 'синонимия', 'антонимия', 'полисемия', 'архаизм', 'неологизм', 'варваризм', 'регионализм', 'жаргонизм', 'профессионализм', 'термин', 'дефиниция', 'коннотация', 'денотация', 'референция', 'прагматика', 'семантика', 'синтаксис', 'морфология', 'фонетика', 'фонология', 'орфоэпия', 'орфография', 'пунктуация', 'стилистика', 'риторика', 'поэтика', 'метрика', 'ритм', 'рифма', 'строфа', 'стихотворение', 'поэма', 'баллада', 'сонет', 'терцина', 'октава', 'александрийский стих', 'ямб', 'хорей', 'дактиль', 'амфибрахий', 'анапест', 'спондей', 'пиррихий', 'цезура', 'анжамбеман', 'каталекс', 'гиперкаталекс', 'акаталекс', 'эмфаза', 'инверсия', 'эллипсис', 'парцелляция', 'градация', 'антиклимакс', 'климакс', 'ретардация', 'пролепсис', 'анахронизм', 'паралипсис', 'апосиопеза', 'риторический вопрос', 'риторическое восклицание', 'риторическое обращение', 'амплификация', 'экспликация', 'импликация', 'презумпция', 'конвенция', 'конвенциональность', 'узуальность', 'окказиональность', 'девиация', 'норма', 'система', 'структура', 'функция', 'дисфункция', 'трансформация', 'интерпретация', 'герменевтика'],
                harry_potter: ['Хогвартс', 'квиддич', 'патронус', 'крестраж', 'дементор', 'магл', 'волшебная палочка', 'Гриффиндор', 'Слизерин', 'Когтевран', 'Пуффендуй', 'Волдеморт', 'Дамблдор', 'Снейп', 'МакГонагалл', 'Хагрид', 'Сириус Блэк', 'Люпин', 'Беллатрикс', 'Нарцисса', 'Люциус Малфой', 'Драко Малфой', 'Невилл Долгопупс', 'Полумна Лавгуд', 'Джинни Уизли', 'Фред Уизли', 'Джордж Уизли', 'Рон Уизли', 'Гермиона Грейнджер', 'Гарри Поттер', 'Авада Кедавра', 'Круциатус', 'Империус', 'Экспеллиармус', 'Экспекто Патронум', 'Ступефай', 'Петрификус Тоталус', 'Левиоса', 'Люмос', 'Нокс', 'Алохомора', 'Репаро', 'Обливиейт', 'Протеан', 'Полиджус', 'Верасерум', 'Феликс Фелицис', 'Амортенция', 'Мандрагора', 'Плакса Миртл', 'Почти Безголовый Ник', 'Кровавый Барон', 'Серая Дама', 'Добби', 'Винки', 'Кричер', 'Фенрир Грейбэк', 'Петер Петтигрю', 'Баркас Крауч', 'Долорес Амбридж', 'Корнелиус Фадж', 'Руфус Скримджер', 'Кингсли Бэкболт', 'Тонкс', 'Безумный Глаз Муди', 'Флер Делакур', 'Виктор Крам', 'Седрик Диггори', 'Турнир Трех Волшебников', 'Кубок Огня', 'Золотой Снитч', 'Бладжер', 'Квоффл', 'Мантия-невидимка', 'Маховик времени', 'Карта мародеров', 'Живые портреты', 'Движущиеся лестницы', 'Тайная комната', 'Василиск', 'Меч Гриффиндора', 'Сортировочная шляпа', 'Философский камень', 'Эликсир жизни', 'Николас Фламель', 'Запретный лес', 'Паук Арагог', 'Единорог', 'Кентавр', 'Гиппогриф', 'Теструл', 'Дракон', 'Норберт', 'Пушистик', 'Нагайна', 'Хедвига', 'Крысавка', 'Живоглот', 'Косая аллея', 'Лютный переулок', 'Гринготтс', 'Галеон', 'Сикль', 'Кнут'],
                lotr: ['Средиземье', 'хоббит', 'Гондор', 'Мордор', 'эльф', 'орк', 'Шир', 'Изенгард', 'Роhan', 'Минас Тирит', 'Минас Моргул', 'Барад-дур', 'Ортханк', 'Эдорас', 'Хельмова Падь', 'Фангорн', 'Лориэн', 'Раздол', 'Эребор', 'Озерный город', 'Дол Гулдур', 'Ангмар', 'Арнор', 'Линдон', 'Серые Гавани', 'Мория', 'Казад-дум', 'Железные Холмы', 'Одинокая Гора', 'Лихолесье', 'Пустошь Дракона', 'Гномьи Земли', 'Фродо', 'Сэм', 'Мерри', 'Пиппин', 'Гэндальф', 'Арагорн', 'Легалас', 'Гимли', 'Боромир', 'Саруман', 'Саурон', 'Элронд', 'Галадриэль', 'Келеборн', 'Арвен', 'Эомер', 'Эовин', 'Теоден', 'Денетор', 'Фарамир', 'Имладрис', 'Валинор', 'Валар', 'Майар', 'Илуватар', 'Сильмариллы', 'Нарсил', 'Андурил', 'Стинг', 'Глэмдринг', 'Оркрист', 'Палантир', 'Кольцо Власти', 'Одно Кольцо', 'Девять колец', 'Семь колец', 'Три кольца', 'Виллар', 'Нарья', 'Нения', 'назгул', 'Король-чародей', 'Устье Андуина', 'Пеленнорские поля', 'Черные врата', 'Ородруин', 'Роковая гора', 'Кирит Унгол', 'Итилиэн', 'Энтвайвз', 'энты', 'орлы', 'Гваихир', 'Шелоб', 'Смауг', 'Глум', 'Голлум', 'Бильбо', 'Торин', 'Двалин', 'Балин', 'Фили', 'Кили', 'Ори', 'Нори', 'Дори', 'Оин', 'Глоин', 'Бифур', 'Бофур', 'Бомбур', 'Берен', 'Лутиэн', 'Турин', 'Тингол', 'Мелиан', 'Финрод', 'Гиль-галад', 'Исилдур', 'Анарион', 'Эленциль', 'Эарендил']
            },
            extreme: {
                general: ['экзистенциализм', 'феноменология', 'герменевтика', 'эпистемология', 'онтология', 'гносеология', 'аксиология', 'дискурс', 'парадигма', 'синергетика', 'редукционизм', 'холизм', 'детерминизм', 'индетерминизм', 'фатализм', 'волюнтаризм', 'солипсизм', 'агностицизм', 'эмпиризм', 'рационализм', 'интуитивизм', 'прагматизм', 'позитивизм', 'неопозитивизм', 'постпозитивизм', 'структурализм', 'постструктурализм', 'деконструкция', 'семиотика', 'семантика', 'синтактика', 'прагматика', 'коннотация', 'денотация', 'дискретность', 'континуальность', 'дихотомия', 'антиномия', 'апория', 'аподиктичность', 'каузальность', 'телеология', 'эсхатология', 'сотериология', 'теодицея', 'апофатический', 'катафатический', 'трансцендентный', 'имманентный', 'трансцендентальный', 'ноуменальный', 'феноменальный', 'априорный', 'апостериорный', 'аналитический', 'синтетический', 'индуктивный', 'дедуктивный', 'абдуктивный', 'силлогизм', 'энтимема', 'сорит', 'полисиллогизм', 'дилемма', 'тетралемма', 'мереология', 'топология', 'категория', 'субстанция', 'акциденция', 'атрибут', 'модус', 'эссенция', 'экзистенция', 'потенция', 'актуальность', 'виртуальность', 'симулякр', 'гиперреальность', 'интертекстуальность', 'метанарратив', 'эпистема', 'диспозитив', 'ризома', 'номадология', 'шизоанализ', 'микрофизика власти', 'биовласть', 'биополитика', 'некрополитика', 'генеалогия', 'археология знания', 'дискурсивная формация', 'хронотоп', 'гетеротопия', 'утопия', 'дистопия', 'панноптикум', 'либидо', 'бессознательное', 'предсознательное', 'сознательное', 'архетип', 'коллективное бессознательное', 'персона', 'анима', 'анимус'],
                harry_potter: ['Хогвартс', 'квиддич', 'патронус', 'крестраж', 'дементор', 'магл', 'волшебная палочка', 'Гриффиндор', 'Слизерин', 'Когтевран', 'Пуффендуй', 'Авада Кедавра', 'Круциатус', 'Империус', 'Экспеллиармус', 'Экспекто Патронум', 'Ступефай', 'Петрификус Тоталус', 'Левиоса', 'Люмос', 'Нокс', 'Алохомора', 'Репаро', 'Обливиейт', 'Протеан', 'Полиджус', 'Верасерум', 'Феликс Фелицис', 'Амортенция', 'Мандрагора', 'Золотой Снитч', 'Бладжер', 'Квоффл', 'Мантия-невидимка', 'Маховик времени', 'Карта мародеров', 'Живые портреты', 'Движущиеся лестницы', 'Тайная комната', 'Василиск', 'Меч Гриффиндора', 'Сортировочная шляпа', 'Философский камень', 'Эликсир жизни', 'Николас Фламель', 'Запретный лес', 'Паук Арагог', 'Единорог', 'Кентавр', 'Гиппогриф', 'Теструл', 'Дракон', 'Норберт', 'Пушистик', 'Нагайна', 'Хедвига', 'Крысавка', 'Живоглот', 'Косая аллея', 'Лютный переулок', 'Гринготтс', 'Галеон', 'Сикль', 'Кнут', 'Олливандерс', 'Борджин и Беркс', 'Дырявый котел', 'Платформа 9¾', 'Хогвартс-экспресс', 'Большой зал', 'Гостиная', 'Спальня', 'Больничное крыло', 'Кабинет директора', 'Кабинет профессора', 'Библиотека', 'Запретная секция', 'Подземелья', 'Астрономическая башня', 'Комната Требований', 'Выручай-комната', 'Плачущая Миртл', 'Почти Безголовый Ник', 'Кровавый Барон', 'Серая Дама', 'Толстая Дама', 'Добби', 'Винки', 'Кричер', 'Букля', 'Клювокрыл', 'Арагог', 'Мохноногий', 'Флаффи', 'Гремучая ива', 'Мандрагора', 'Дьявольские силки', 'Буйнопод', 'Щупальцевидный плющ', 'Снарглы', 'Морщерогие кизляки', 'Поттервотч', 'Пророк'],
                lotr: ['Средиземье', 'Шир', 'Хоббитания', 'Хоббитон', 'Торбин-на-Круче', 'Брендидуим', 'Брендизайка', 'Старый лес', 'Древень', 'Том Бомбадил', 'Златеника', 'Курганы', 'Курганщики', 'Бри', 'Заскочка пони', 'Старик Ива', 'Раздол', 'Имладрис', 'Элронд', 'Арвен', 'Глорфиндел', 'Эресторас', 'Линдир', 'Мория', 'Казад-дум', 'Балин', 'Ори', 'Оин', 'Балрог', 'Дурин', 'Лориэн', 'Карас Галадон', 'Галадриэль', 'Келеборн', 'Халдир', 'Румил', 'Орофин', 'Зеркало Галадриэль', 'Нимродель', 'Амрот', 'Кирит Унгол', 'Шелоб', 'Итилиэн', 'Осгилиат', 'Минас Тирит', 'Минас Моргул', 'Денетор', 'Боромир', 'Фарамир', 'Арагорн', 'Стрид', 'Элессар', 'Андурил', 'Пламя Запада', 'Нарсил', 'Палантир', 'Ортханк', 'Изенгард', 'Саруман', 'Гримуорм', 'Урукхай', 'Лурц', 'Углук', 'Роhan', 'Эдорас', 'Медуселд', 'Теоден', 'Эомер', 'Эовин', 'Дернхельм', 'Бьега', 'Легалас', 'Лучник', 'Гимли', 'Фангорн', 'Энтмут', 'Древобрад', 'Скороход', 'Листошелест', 'Кожебород', 'Энтинги', 'Хуорны', 'Барбадиль', 'Фламбард', 'Фимбретиль', 'Энтжены', 'Пеленнорские поля', 'Черные врата', 'Мораннон', 'Кирит Горгор', 'Уст Горгор', 'Мордор', 'Барад-дур', 'Саурон', 'Некромант', 'Всевидящее Око', 'Одно Кольцо', 'Девять', 'назгул', 'Кольценосцы', 'Король-чародей', 'Ангмарский Владыка', 'Кхамул', 'Фелзверы', 'Роковая гора']
            }
        };

        // Звуковые эффекты
        const sounds = {
            button: () => playTone(220, 100, soundSettings.buttons),
            correct: () => playTone(440, 200, soundSettings.effects),
            incorrect: () => playTone(165, 300, soundSettings.effects),
            timer: () => playTone(880, 100, soundSettings.timer),
            roundEnd: () => playTone(330, 500, soundSettings.effects)
        };

        // Функция создания тона
        function playTone(frequency, duration, volume = 50) {
            if (!soundSettings.enabled) return;
            
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = frequency;
                oscillator.type = 'sine';
                
                const finalVolume = (soundSettings.master / 100) * (volume / 100) * 0.1;
                
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(finalVolume, audioContext.currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration / 1000);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration / 1000);
            } catch (e) {
                console.warn('Не удалось воспроизвести звук:', e);
            }
        }

        // Список случайных имен для команд
        const randomTeamNames = [
            'Огненные Драконы', 'Ледяные Волки', 'Золотые Орлы', 'Серебряные Акулы',
            'Алмазные Тигры', 'Рубиновые Львы', 'Изумрудные Змеи', 'Сапфировые Дельфины',
            'Космические Рейнджеры', 'Кибер Ниндзя', 'Квантовые Воины', 'Атомные Герои',
            'Молнии Зевса', 'Титаны Олимпа', 'Феникс Райт', 'Стальные Пантеры',
            'Цифровые Пираты', 'Неоновые Рыцари', 'Лазерные Барсы', 'Плазменные Единороги'
        ];

        // Инициализация
        function init() {
            // Показываем лоадер
            setTimeout(() => {
                document.getElementById('loader').style.display = 'none';
                document.getElementById('mainMenu').classList.add('active');
            }, 2000);

            // Загружаем настройки звука
            loadSoundSettings();

            // Добавляем две команды по умолчанию
            teams = [
                { name: 'Команда 1', score: 0 },
                { name: 'Команда 2', score: 0 }
            ];
            renderTeams();

            // Добавляем обработчики для категорий
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', toggleCategory);
            });

            // Настройка свайпов для игровой карточки
            setupCardSwipe();

            // Настройка звуковых ползунков
            setupSoundControls();

            // Добавляем звуки кнопок
            document.querySelectorAll('.menu-button, .back-button, .control-btn').forEach(btn => {
                btn.addEventListener('click', () => playSound('button'));
            });

            // Обновляем глобальную кнопку звука
            updateGlobalSoundButton();
        }

        // Настройки звука
        function loadSoundSettings() {
            const saved = localStorage.getItem('aliasSound');
            if (saved) {
                soundSettings = {...soundSettings, ...JSON.parse(saved)};
                updateSoundUI();
            }
        }

        function saveSoundSettings() {
            localStorage.setItem('aliasSound', JSON.stringify(soundSettings));
            updateGlobalSoundButton();
        }

        function setupSoundControls() {
            const controls = ['master', 'button', 'timer', 'effects'];
            controls.forEach(type => {
                const slider = document.getElementById(`${type}Volume`);
                const value = document.getElementById(`${type}VolumeValue`);
                
                if (slider && value) {
                    const soundType = type === 'button' ? 'buttons' : type;
                    slider.value = soundSettings[soundType];
                    value.textContent = slider.value + '%';
                    
                    slider.addEventListener('input', (e) => {
                        const val = e.target.value;
                        soundSettings[soundType] = parseInt(val);
                        value.textContent = val + '%';
                        saveSoundSettings();
                    });
                }
            });
        }

        function updateSoundUI() {
            const controls = ['master', 'button', 'timer', 'effects'];
            controls.forEach(type => {
                const slider = document.getElementById(`${type}Volume`);
                const value = document.getElementById(`${type}VolumeValue`);
                
                if (slider && value) {
                    const soundType = type === 'button' ? 'buttons' : type;
                    slider.value = soundSettings[soundType];
                    value.textContent = soundSettings[soundType] + '%';
                }
            });
        }

        function playSound(type) {
            if (sounds[type]) {
                sounds[type]();
            }
        }

        function toggleGlobalSound() {
            soundSettings.enabled = !soundSettings.enabled;
            saveSoundSettings();
            updateGlobalSoundButton();
            playSound('button');
        }

        function updateGlobalSoundButton() {
            const btn = document.getElementById('globalSoundToggle');
            btn.textContent = soundSettings.enabled ? '🔊' : '🔇';
            btn.classList.toggle('muted', !soundSettings.enabled);
        }

        function testSounds() {
            setTimeout(() => playSound('button'), 100);
            setTimeout(() => playSound('correct'), 500);
            setTimeout(() => playSound('incorrect'), 1000);
            setTimeout(() => playSound('timer'), 1500);
            setTimeout(() => playSound('roundEnd'), 2000);
        }

        // Переключение между страницами
        function showPage(pageId) {
            playSound('button');
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
        }

        // Начать новую игру
        function startNewGame() {
            playSound('button');
            gameEnded = false;
            teams = [
                { name: 'Команда 1', score: 0 },
                { name: 'Команда 2', score: 0 }
            ];
            renderTeams();
            showPage('teamSetup');
        }

        // Управление командами
        function renderTeams() {
            const teamList = document.getElementById('teamList');
            teamList.innerHTML = '';
            
            teams.forEach((team, index) => {
                const teamItem = document.createElement('div');
                teamItem.className = 'team-item';
                teamItem.innerHTML = `
                    <span class="team-name">${team.name}</span>
                    <span class="team-score">${team.score}</span>
                `;
                teamItem.onclick = () => editTeam(index);
                teamList.appendChild(teamItem);
            });
        }

        function addTeam() {
            playSound('button');
            if (teams.length >= 10) {
                alert('Максимум 10 команд!');
                return;
            }
            
            const randomName = randomTeamNames[Math.floor(Math.random() * randomTeamNames.length)];
            teams.push({ name: randomName, score: 0 });
            renderTeams();
        }

        function editTeam(index) {
            playSound('button');
            currentEditingTeam = index;
            document.getElementById('teamNameInput').value = teams[index].name;
            document.getElementById('teamModal').classList.add('active');
        }

        function saveTeamName() {
            playSound('button');
            const newName = document.getElementById('teamNameInput').value.trim();
            if (newName) {
                teams[currentEditingTeam].name = newName;
                renderTeams();
            }
            closeModal();
        }

        function deleteTeam() {
            playSound('button');
            if (teams.length > 2) {
                teams.splice(currentEditingTeam, 1);
                renderTeams();
            } else {
                alert('Минимум 2 команды!');
            }
            closeModal();
        }

        function closeModal() {
            playSound('button');
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.remove('active');
            });
        }

        // Управление категориями
        function toggleCategory(e) {
            playSound('button');
            const btn = e.target.closest('.category-btn');
            const type = btn.dataset.type;
            
            if (type === 'difficulty') {
                // Для сложности - только один выбор
                document.querySelectorAll(`[data-type="difficulty"]`).forEach(b => {
                    b.classList.remove('selected');
                });
            }
            
            btn.classList.toggle('selected');
        }

        // Начать игру
        function startGame() {
            playSound('button');
            
            // Сохраняем настройки
            gameSettings = {
                roundTime: parseInt(document.getElementById('roundTime').value),
                winScore: parseInt(document.getElementById('winScore').value),
                skipPenalty: document.getElementById('skipPenalty').checked,
                betAmount: parseInt(document.getElementById('betAmount').value)
            };

            // Подготавливаем слова
            prepareGameWords();
            
            // Сбрасываем счет
            teams.forEach(team => team.score = 0);
            currentTeamIndex = 0;
            gameEnded = false;
            
            // Показываем игровой экран
            showPage('gameScreen');
            prepareRound();
        }

        function prepareGameWords() {
            gameWords = [];
            
            // Получаем выбранную сложность
            const difficultyBtn = document.querySelector('[data-type="difficulty"].selected');
            const difficulty = difficultyBtn ? difficultyBtn.dataset.value : 'easy';
            
            // Получаем выбранные темы
            const selectedThemes = Array.from(document.querySelectorAll('[data-type="theme"].selected'))
                .map(btn => btn.dataset.value);
            
            // Если темы не выбраны, используем общие слова
            if (selectedThemes.length === 0) {
                selectedThemes.push('general');
            }
            
            // Собираем слова из выбранных категорий
            selectedThemes.forEach(theme => {
                if (wordDictionaries[difficulty] && wordDictionaries[difficulty][theme]) {
                    gameWords.push(...wordDictionaries[difficulty][theme]);
                }
            });
            
            // Перемешиваем слова
            gameWords.sort(() => Math.random() - 0.5);
        }

        function prepareRound() {
            const currentTeam = teams[currentTeamIndex];
            document.getElementById('currentTeam').textContent = currentTeam.name;
            document.getElementById('headerScore').textContent = `Очки: ${currentTeam.score}`;
            document.getElementById('cardText').textContent = 'Готов?';
            
            roundWords = { correct: [], incorrect: [] };
            timeLeft = gameSettings.roundTime;
            updateTimer();
            
            // Ждем свайп для начала
            waitForReady();
        }

        function waitForReady() {
            const card = document.getElementById('gameCard');
            card.dataset.mode = 'ready';
        }

        function startRound() {
            playSound('button');
            
            // Обратный отсчет
            let countdown = 3;
            const card = document.getElementById('gameCard');
            card.dataset.mode = 'countdown';
            
            const countdownInterval = setInterval(() => {
                document.getElementById('cardText').textContent = countdown;
                countdown--;
                
                if (countdown < 0) {
                    clearInterval(countdownInterval);
                    card.dataset.mode = 'game';
                    showNextWord();
                    startTimer();
                }
            }, 1000);
        }

        function showNextWord() {
            if (gameWords.length > 0) {
                currentWord = gameWords.shift();
                document.getElementById('cardText').textContent = currentWord;
            } else {
                // Если слова закончились, перемешиваем заново
                prepareGameWords();
                showNextWord();
            }
        }

        function handleWordResult(isCorrect) {
            const currentTeam = teams[currentTeamIndex];
            
            if (isCorrect) {
                currentTeam.score++;
                roundWords.correct.push(currentWord);
                playSound('correct');
            } else {
                if (gameSettings.skipPenalty) {
                    currentTeam.score = Math.max(0, currentTeam.score - 1);
                }
                roundWords.incorrect.push(currentWord);
                playSound('incorrect');
            }
            
            document.getElementById('headerScore').textContent = `Очки: ${currentTeam.score}`;
            showNextWord();
        }

        function startTimer() {
            timer = setInterval(() => {
                timeLeft--;
                updateTimer();
                
                if (timeLeft <= 10 && timeLeft > 0) {
                    playSound('timer');
                    document.getElementById('gameTimer').classList.add('warning');
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    playSound('roundEnd');
                    endRound();
                }
            }, 1000);
        }

        function updateTimer() {
            document.getElementById('gameTimer').textContent = timeLeft;
        }

        function pauseGame() {
            playSound('button');
            if (timer) {
                clearInterval(timer);
                isPaused = true;
                document.getElementById('pauseModal').classList.add('active');
            }
        }

        function resumeGame() {
            playSound('button');
            isPaused = false;
            closeModal();
            if (timeLeft > 0 && !gameEnded) {
                startTimer();
            }
        }

        function exitToMenu() {
            playSound('button');
            document.getElementById('pauseModal').classList.add('active');
        }

        function exitToMenuConfirm() {
            playSound('button');
            clearInterval(timer);
            isPaused = false;
            gameEnded = true;
            closeModal();
            showPage('mainMenu');
        }

        function endRound() {
            clearInterval(timer);
            document.getElementById('gameTimer').classList.remove('warning');
            showRoundResults();
        }

        function showRoundResults() {
            showPage('roundResults');
            
            const resultsList = document.getElementById('resultsList');
            resultsList.innerHTML = '';
            
            // Показываем угаданные слова
            roundWords.correct.forEach((word, index) => {
                const wordDiv = document.createElement('div');
                wordDiv.className = 'word-result correct';
                wordDiv.innerHTML = `<span>${word}</span><span>+1</span>`;
                wordDiv.onclick = () => toggleWordResult(word, index, true);
                resultsList.appendChild(wordDiv);
            });
            
            // Показываем пропущенные слова
            roundWords.incorrect.forEach((word, index) => {
                const wordDiv = document.createElement('div');
                wordDiv.className = 'word-result incorrect';
                const penalty = gameSettings.skipPenalty ? '-1' : '0';
                wordDiv.innerHTML = `<span>${word}</span><span>${penalty}</span>`;
                wordDiv.onclick = () => toggleWordResult(word, index, false);
                resultsList.appendChild(wordDiv);
            });
            
            document.getElementById('correctCount').textContent = roundWords.correct.length;
            document.getElementById('incorrectCount').textContent = roundWords.incorrect.length;
        }

        function toggleWordResult(word, index, wasCorrect) {
            playSound('button');
            const currentTeam = teams[currentTeamIndex];
            
            if (wasCorrect) {
                // Перемещаем из правильных в неправильные
                roundWords.correct.splice(index, 1);
                roundWords.incorrect.push(word);
                currentTeam.score--;
                if (gameSettings.skipPenalty) {
                    currentTeam.score = Math.max(0, currentTeam.score - 1);
                }
            } else {
                // Перемещаем из неправильных в правильные
                roundWords.incorrect.splice(index, 1);
                roundWords.correct.push(word);
                currentTeam.score++;
                if (gameSettings.skipPenalty) {
                    currentTeam.score++;
                }
            }
            
            showRoundResults();
        }

        function nextRound() {
            playSound('button');
            
            // Переходим к следующей команде
            currentTeamIndex = (currentTeamIndex + 1) % teams.length;
            
            // Проверяем условия победы после полного раунда
            if (currentTeamIndex === 0) {
                checkForWinner();
            } else {
                // Продолжаем игру со следующей командой
                showPage('gameScreen');
                prepareRound();
            }
        }

        function checkForWinner() {
            const maxScore = Math.max(...teams.map(team => team.score));
            const teamsWithMaxScore = teams.filter(team => team.score === maxScore);
            
            // Победитель определяется если:
            // 1. Максимальный счет >= минимального для победы
            // 2. И есть команда с явным превосходством
            if (maxScore >= gameSettings.winScore && teamsWithMaxScore.length === 1) {
                endGame();
            } else {
                // Продолжаем игру
                showPage('gameScreen');
                prepareRound();
            }
        }

        function endGame() {
            clearInterval(timer);
            gameEnded = true;
            
            // Находим команду с максимальным счетом
            const maxScore = Math.max(...teams.map(team => team.score));
            const winners = teams.filter(team => team.score === maxScore);
            
            if (winners.length === 1) {
                const winner = winners[0];
                document.getElementById('winnerName').textContent = winner.name;
                document.getElementById('finalScore').textContent = winner.score;
            } else {
                document.getElementById('winnerName').textContent = 'Ничья!';
                document.getElementById('finalScore').textContent = maxScore;
            }
            
            // Рассчитываем призовой фонд
            const prizePool = gameSettings.betAmount * teams.length;
            document.getElementById('prizeAmount').textContent = prizePool;
            
            showPage('finalResults');
            
            // Сохраняем статистику
            saveGameStats(winners.length === 1 ? winners[0] : null);
        }

        function saveGameStats(winner) {
            const stats = JSON.parse(localStorage.getItem('aliasStats') || '[]');
            stats.push({
                date: new Date().toISOString(),
                winner: winner ? winner.name : 'Ничья',
                score: winner ? winner.score : Math.max(...teams.map(team => team.score)),
                teams: teams.map(t => ({ name: t.name, score: t.score }))
            });
            localStorage.setItem('aliasStats', JSON.stringify(stats));
        }

        // Настройка свайпов (изменено управление: влево - неправильно, вправо - правильно)
        function setupCardSwipe() {
            const card = document.getElementById('gameCard');
            const leftIndicator = document.querySelector('.swipe-indicator.left');
            const rightIndicator = document.querySelector('.swipe-indicator.right');
            
            card.addEventListener('mousedown', startDrag);
            card.addEventListener('touchstart', startDrag, { passive: false });
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag, { passive: false });
            
            document.addEventListener('mouseup', endDrag);
            document.addEventListener('touchend', endDrag);
            
            function startDrag(e) {
                e.preventDefault();
                isDragging = true;
                startX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                card.classList.add('dragging');
            }
            
            function drag(e) {
                if (!isDragging) return;
                
                e.preventDefault();
                currentX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                const deltaX = currentX - startX;
                
                card.style.transform = `translateX(${deltaX}px) rotate(${deltaX * 0.1}deg)`;
                
                // Показываем индикаторы
                if (deltaX < -50) {
                    leftIndicator.classList.add('active');
                    rightIndicator.classList.remove('active');
                } else if (deltaX > 50) {
                    rightIndicator.classList.add('active');
                    leftIndicator.classList.remove('active');
                } else {
                    leftIndicator.classList.remove('active');
                    rightIndicator.classList.remove('active');
                }
            }
            
            function endDrag(e) {
                if (!isDragging) return;
                
                isDragging = false;
                card.classList.remove('dragging');
                
                const deltaX = currentX - startX;
                const mode = card.dataset.mode;
                
                if (Math.abs(deltaX) > 100) {
                    if (mode === 'ready' && deltaX > 0) {
                        startRound();
                    } else if (mode === 'game' && !gameEnded) {
                        handleWordResult(deltaX > 0); // вправо = правильно, влево = неправильно
                    }
                }
                
                // Возвращаем карточку на место
                card.style.transform = '';
                leftIndicator.classList.remove('active');
                rightIndicator.classList.remove('active');
            }
        }

        // Инициализация при загрузке
        window.addEventListener('DOMContentLoaded', init);
        
        // Предотвращение скролла на мобильных устройствах
        document.addEventListener('touchmove', function(e) {
            if (e.target.closest('.game-card')) {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>

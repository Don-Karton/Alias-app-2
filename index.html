<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alias Game - DiSpace</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        /* Обновленный лоадер */
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            color: white;
        }

        .loader-logo {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 40px;
            animation: logoGlow 2s ease-in-out infinite;
            text-shadow: 0 0 20px rgba(255,255,255,0.5);
        }

        .loader-progress {
            width: 300px;
            height: 12px;
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 20px;
            position: relative;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.2);
        }

        .loader-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #fff 0%, #a8edea 50%, #fed6e3 100%);
            border-radius: 20px;
            width: 0%;
            animation: progressWave 3s ease-in-out forwards;
            box-shadow: 0 0 20px rgba(255,255,255,0.6);
            position: relative;
        }

        .loader-progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }

        .loader-text {
            font-size: 18px;
            font-weight: 600;
            opacity: 0.9;
            animation: textPulse 2s ease-in-out infinite;
        }

        @keyframes logoGlow {
            0%, 100% { 
                text-shadow: 0 0 20px rgba(255,255,255,0.5);
                transform: scale(1);
            }
            50% { 
                text-shadow: 0 0 30px rgba(255,255,255,0.8), 0 0 40px rgba(255,255,255,0.6);
                transform: scale(1.05);
            }
        }

        @keyframes progressWave {
            0% { 
                width: 0%; 
                box-shadow: 0 0 20px rgba(255,255,255,0.3);
            }
            50% { 
                width: 70%; 
                box-shadow: 0 0 30px rgba(255,255,255,0.7);
            }
            100% { 
                width: 100%; 
                box-shadow: 0 0 40px rgba(255,255,255,0.9);
            }
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(300px); }
        }

        @keyframes textPulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 10px;
            min-height: 100vh;
            position: relative;
        }

        .page {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            animation: fadeIn 0.3s ease-in;
            min-height: calc(100vh - 20px);
            position: relative;
        }

        .page.active {
            display: block;
        }

        /* Выпадающее меню звука */
        .sound-dropdown {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
        }

        .sound-dropdown-toggle {
            width: 45px;
            height: 45px;
            border: none;
            border-radius: 50%;
            background: rgba(102, 126, 234, 0.9);
            color: white;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .sound-dropdown-toggle:hover {
            background: rgba(102, 126, 234, 1);
            transform: scale(1.1);
        }

        .sound-dropdown-menu {
            position: absolute;
            top: 55px;
            right: 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            padding: 8px;
            min-width: 120px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
        }

        .sound-dropdown.active .sound-dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .sound-dropdown-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 12px;
            cursor: pointer;
            border-radius: 8px;
            transition: background 0.2s ease;
            font-size: 14px;
            color: #333;
            white-space: nowrap;
        }

        .sound-dropdown-item:hover {
            background: #f5f5f5;
        }

        .sound-dropdown-item.active {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }

        /* Игровая шапка - адаптивная */
        .game-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: rgba(102, 126, 234, 0.95);
            color: white;
            backdrop-filter: blur(10px);
            z-index: 999;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            height: 60px;
        }

        .game-score {
            font-size: 16px;
            font-weight: 600;
        }

        .game-controls {
            display: flex;
            gap: 8px;
        }

        .control-btn {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            background: rgba(255,255,255,0.9);
            color: #667eea;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .control-btn:hover {
            background: white;
            transform: scale(1.1);
        }

        .control-btn.muted {
            background: rgba(255,0,0,0.9);
            color: white;
        }

        /* Игровая страница с учетом фиксированной шапки */
        .game-screen {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 0;
            border-radius: 0;
            min-height: 100vh;
        }

        .game-content {
            padding-top: 70px;
            padding-bottom: 120px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .current-team {
            text-align: center;
            font-size: clamp(18px, 5vw, 20px);
            color: white;
            margin: 15px 0;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1, h2 {
            text-align: center;
            margin-bottom: 30px;
            color: #667eea;
        }

        h1 {
            font-size: clamp(24px, 6vw, 32px);
        }

        h2 {
            font-size: clamp(20px, 5vw, 24px);
        }

        .menu-button {
            display: block;
            width: 100%;
            padding: 18px;
            margin: 10px 0;
            border: none;
            border-radius: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: clamp(16px, 4vw, 18px);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
        }

        .menu-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .menu-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .team-list {
            margin: 20px 0;
        }

        .team-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            margin: 10px 0;
            background: #f7f7f7;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
        }

        .team-item:hover {
            background: #e9e9e9;
        }

        .team-name {
            font-size: clamp(16px, 4vw, 18px);
            font-weight: 500;
        }

        .team-score {
            font-size: clamp(20px, 5vw, 24px);
            font-weight: bold;
            color: #667eea;
        }

        .add-team-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            margin: 20px auto;
            border: 3px dashed #667eea;
            border-radius: 50%;
            background: white;
            color: #667eea;
            font-size: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
        }

        .add-team-btn:hover {
            background: #667eea;
            color: white;
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .category-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 10px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            background: white;
            font-size: clamp(13px, 3vw, 16px);
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
            min-height: 90px;
            position: relative;
        }

        .category-btn:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .category-btn.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .category-icon {
            font-size: 24px;
            margin-bottom: 6px;
        }

        .category-tooltip {
            font-size: 10px;
            opacity: 0.7;
            text-align: center;
            margin-top: 4px;
        }

        /* Стиль барабана для сложности */
        .difficulty-selector {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px 15px;
            border: 1px solid #e9ecef;
        }

        .difficulty-btn {
            width: 45px;
            height: 45px;
            border: 2px solid #667eea;
            border-radius: 50%;
            background: white;
            color: #667eea;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            user-select: none;
        }

        .difficulty-btn:hover {
            background: #667eea;
            color: white;
            transform: scale(1.1);
        }

        .difficulty-display {
            min-width: 130px;
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 15px;
            border: 2px solid #e9ecef;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .difficulty-level {
            font-size: 28px;
            margin-bottom: 6px;
        }

        .difficulty-name {
            font-size: 16px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 4px;
        }

        .difficulty-desc {
            font-size: 11px;
            color: #666;
        }

        /* Настройки игры */
        .settings-group {
            margin: 25px 0;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            border: 1px solid #e9ecef;
        }

        .settings-group label {
            display: block;
            margin-bottom: 15px;
            font-weight: 600;
            font-size: clamp(15px, 4vw, 18px);
            color: #667eea;
            text-align: center;
        }

        .setting-control {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 15px 0;
        }

        .setting-btn {
            width: 40px;
            height: 40px;
            border: 2px solid #667eea;
            border-radius: 50%;
            background: white;
            color: #667eea;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            user-select: none;
        }

        .setting-btn:hover {
            background: #667eea;
            color: white;
            transform: scale(1.1);
        }

        .setting-btn:active {
            transform: scale(0.95);
        }

        .setting-value {
            min-width: 70px;
            text-align: center;
            font-size: clamp(20px, 5vw, 28px);
            font-weight: bold;
            color: #667eea;
            padding: 8px 15px;
            background: white;
            border-radius: 12px;
            border: 2px solid #e9ecef;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .bet-slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
            margin: 20px 0;
        }

        .bet-slider::-webkit-slider-thumb {
            appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }

        .bet-slider::-moz-range-thumb {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }

        .bet-value {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #667eea;
            margin-top: 10px;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            gap: 15px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }

        .checkbox-group input[type="checkbox"] {
            width: 24px;
            height: 24px;
            accent-color: #667eea;
        }

        .checkbox-group label {
            font-size: clamp(14px, 3vw, 16px);
            margin: 0;
            color: #333;
            text-align: left;
        }

        /* Игровое поле */
        .game-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            padding: 20px;
            position: relative;
        }

        .game-card {
            position: relative;
            width: min(300px, 85vw);
            height: min(300px, 40vh);
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            border: 4px solid #667eea;
            border-radius: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
            font-size: clamp(20px, 5vw, 32px);
            font-weight: bold;
            cursor: grab;
            user-select: none;
            transition: all 0.3s ease;
            touch-action: none;
            text-align: center;
            padding: 20px;
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.3);
        }

        .game-card.dragging {
            cursor: grabbing;
        }

        .game-card.countdown {
            font-size: clamp(60px, 15vw, 120px);
            color: #667eea;
            animation: countdownPulse 1s ease-in-out;
        }

        @keyframes countdownPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        /* Фоновые подсказки для свайпов */
        .swipe-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            pointer-events: none;
        }

        .swipe-bg-left, .swipe-bg-right {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(24px, 6vw, 36px);
            opacity: 0.1;
            transition: opacity 0.3s ease;
        }

        .swipe-bg-left {
            color: #ff6b6b;
            background: linear-gradient(to right, rgba(255,107,107,0.1), transparent);
        }

        .swipe-bg-right {
            color: #51cf66;
            background: linear-gradient(to left, rgba(81,207,102,0.1), transparent);
        }

        .swipe-bg-left.active, .swipe-bg-right.active {
            opacity: 0.4;
            animation: swipePulse 0.5s ease-in-out;
        }

        @keyframes swipePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Визуальные подсказки внизу */
        .swipe-hints {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 350px;
            margin-top: 20px;
        }

        .swipe-hint {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            color: white;
            animation: hintPulse 3s ease-in-out infinite;
        }

        .swipe-hint.left {
            background: linear-gradient(135deg, #ff6b6b, #ff5252);
        }

        .swipe-hint.right {
            background: linear-gradient(135deg, #51cf66, #4caf50);
        }

        .swipe-hint.ready {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        @keyframes hintPulse {
            0%, 100% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        .swipe-indicators {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            border-radius: 21px;
            overflow: hidden;
        }

        .swipe-indicator {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 56px;
            font-weight: bold;
        }

        .swipe-indicator.left {
            background: linear-gradient(135deg, rgba(255,107,107,0.4), rgba(255,82,82,0.4));
            color: #ff3030;
        }

        .swipe-indicator.right {
            background: linear-gradient(135deg, rgba(81,207,102,0.4), rgba(76,175,80,0.4));
            color: #2e7d32;
        }

        .swipe-indicator.active {
            opacity: 1;
        }

        /* Таймер зафиксирован внизу экрана */
        .game-timer {
            position: fixed;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            width: min(180px, 45vw);
            height: 70px;
            background: rgba(255,255,255,0.95);
            border-radius: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(28px, 7vw, 42px);
            font-weight: bold;
            color: #667eea;
            box-shadow: 0 8px 25px rgba(0,0,0,0.25);
            z-index: 1000;
            border: 3px solid #667eea;
        }

        .game-timer.warning {
            background: linear-gradient(135deg, rgba(255,193,7,0.95), rgba(255,152,0,0.95));
            color: #d32f2f;
            animation: timerPulse 1s infinite;
            border-color: #d32f2f;
        }

        @keyframes timerPulse {
            0%, 100% { transform: translateX(-50%) scale(1); box-shadow: 0 8px 25px rgba(0,0,0,0.25); }
            50% { transform: translateX(-50%) scale(1.1); box-shadow: 0 12px 35px rgba(255,0,0,0.4); }
        }

        .results-list {
            margin: 20px 0;
            max-height: 40vh;
            overflow-y: auto;
        }

        .word-result {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 8px 0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
        }

        .word-result.correct {
            background: #4caf50;
            color: white;
        }

        .word-result.incorrect {
            background: #f44336;
            color: white;
        }

        .word-result:active {
            transform: scale(0.98);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            padding: 20px;
            background: #f7f7f7;
            border-radius: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: clamp(28px, 7vw, 36px);
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: clamp(12px, 3vw, 14px);
            color: #666;
            margin-top: 5px;
        }

        /* Праздничное окно победы */
        .victory-page {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .victory-page::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 20%, rgba(255,215,0,0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 40%, rgba(255,192,203,0.2) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(173,216,230,0.2) 0%, transparent 50%);
            animation: sparkle 4s ease-in-out infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }

        .victory-content {
            position: relative;
            z-index: 1;
        }

        .victory-title {
            font-size: clamp(32px, 8vw, 48px);
            margin-bottom: 20px;
            animation: victoryPulse 2s ease-in-out infinite;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .victory-winner {
            font-size: clamp(28px, 7vw, 40px);
            margin-bottom: 30px;
            color: #ffd700;
            text-shadow: 
                0 0 10px rgba(255,215,0,0.8),
                0 0 20px rgba(255,215,0,0.6),
                2px 2px 4px rgba(0,0,0,0.3);
            animation: winnerGlow 3s ease-in-out infinite;
        }

        @keyframes victoryPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes winnerGlow {
            0%, 100% { 
                text-shadow: 
                    0 0 10px rgba(255,215,0,0.8),
                    0 0 20px rgba(255,215,0,0.6),
                    2px 2px 4px rgba(0,0,0,0.3);
            }
            50% { 
                text-shadow: 
                    0 0 20px rgba(255,215,0,1),
                    0 0 30px rgba(255,215,0,0.8),
                    0 0 40px rgba(255,215,0,0.6),
                    2px 2px 4px rgba(0,0,0,0.3);
            }
        }

        .victory-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .victory-stat {
            background: rgba(255,255,255,0.15);
            padding: 25px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .victory-stat-value {
            font-size: clamp(32px, 8vw, 44px);
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 8px;
            text-shadow: 0 0 10px rgba(255,215,0,0.5);
        }

        .victory-stat-label {
            font-size: clamp(14px, 3vw, 16px);
            opacity: 0.9;
        }

        .qr-code {
            width: min(180px, 50vw);
            height: min(180px, 50vw);
            margin: 30px auto;
            background: rgba(255,255,255,0.95);
            color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 20px;
            font-size: clamp(12px, 3vw, 16px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            border: 3px solid #ffd700;
        }

        .victory-button {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            margin-top: 20px;
            backdrop-filter: blur(10px);
        }

        .victory-button:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 20px;
            max-width: 380px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-content h3 {
            margin-bottom: 20px;
            color: #667eea;
        }

        .modal-content input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-buttons button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            touch-action: manipulation;
        }

        .modal-buttons .save {
            background: #667eea;
            color: white;
        }

        .modal-buttons .delete {
            background: #f44336;
            color: white;
        }

        .modal-buttons .cancel {
            background: #e0e0e0;
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px 20px;
            background: #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
            font-size: clamp(14px, 3vw, 16px);
        }

        .back-button:hover {
            background: #d0d0d0;
        }

        /* Горизонтальное меню иконок */
        .bottom-menu {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0 15px 0;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 1px solid #e9ecef;
        }

        .bottom-menu-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 55px;
            position: relative;
            background: white;
            border: 2px solid #e9ecef;
        }

        .bottom-menu-item:hover {
            transform: translateY(-2px);
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }

        .bottom-menu-item .icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .bottom-menu-item .label {
            font-size: 9px;
            font-weight: 600;
            color: #667eea;
            text-align: center;
            line-height: 1.2;
        }

        .tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 11px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            margin-bottom: 5px;
            pointer-events: none;
            z-index: 1000;
        }

        .tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 4px solid transparent;
            border-top-color: rgba(0,0,0,0.8);
        }

        .bottom-menu-item:hover .tooltip {
            opacity: 1;
            visibility: visible;
        }

        /* Модальное окно настроек звука */
        .sound-modal .modal-content {
            max-width: 400px;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 20px 0;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 12px;
        }

        .volume-control label {
            min-width: 120px;
            font-size: clamp(13px, 3vw, 15px);
            font-weight: 600;
            color: #667eea;
        }

        .volume-control input[type="range"] {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        .volume-control input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .volume-control .volume-value {
            min-width: 45px;
            text-align: right;
            font-weight: bold;
            color: #667eea;
            font-size: 14px;
        }

        /* О приложении в главном меню */
        .main-menu-about {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            color: #666;
            font-size: clamp(11px, 3vw, 13px);
            line-height: 1.5;
        }

        .main-menu-about h3 {
            color: #667eea;
            margin-bottom: 12px;
            font-size: clamp(15px, 4vw, 17px);
        }

        .main-menu-about p {
            margin-bottom: 8px;
        }

        /* Предупреждение о выборе тем */
        .theme-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            color: #856404;
            font-size: 14px;
            display: none;
        }

        .theme-warning.show {
            display: block;
        }

        /* Адаптивность для мобильных */
        @media (max-width: 480px) {
            .container {
                padding: 5px;
            }
            
            .page {
                padding: 15px;
                border-radius: 10px;
                min-height: calc(100vh - 10px);
            }
            
            .sound-dropdown {
                top: 8px;
                right: 8px;
            }

            .sound-dropdown-toggle {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .game-header {
                padding: 10px 12px;
                height: 55px;
            }

            .game-content {
                padding-top: 65px;
                padding-bottom: 110px;
            }

            .game-score {
                font-size: 14px;
            }

            .control-btn {
                width: 36px;
                height: 36px;
                font-size: 14px;
            }

            .game-controls {
                gap: 6px;
            }

            .current-team {
                font-size: 16px;
                margin: 10px 0;
            }

            .category-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .category-btn {
                padding: 12px 8px;
                min-height: 75px;
            }

            .category-icon {
                font-size: 20px;
            }
            
            .game-card {
                width: 90vw;
                height: 35vh;
                font-size: 18px;
                padding: 15px;
            }

            .game-timer {
                width: 40vw;
                height: 60px;
                font-size: 24px;
                bottom: 12px;
            }

            .difficulty-selector {
                gap: 10px;
                padding: 15px 10px;
            }

            .difficulty-btn {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }

            .difficulty-display {
                min-width: 110px;
                padding: 12px;
            }

            .difficulty-level {
                font-size: 24px;
            }

            .difficulty-name {
                font-size: 14px;
            }

            .setting-control {
                gap: 12px;
            }

            .setting-btn {
                width: 36px;
                height: 36px;
                font-size: 16px;
            }

            .setting-value {
                min-width: 60px;
                font-size: 18px;
                padding: 6px 12px;
            }

            .bottom-menu {
                gap: 12px;
                padding: 8px;
            }

            .bottom-menu-item {
                min-width: 48px;
                padding: 8px;
            }

            .bottom-menu-item .icon {
                font-size: 18px;
            }

            .bottom-menu-item .label {
                font-size: 8px;
            }

            .swipe-hints {
                max-width: 300px;
                margin-top: 15px;
            }

            .swipe-hint {
                padding: 10px 12px;
                font-size: 12px;
                gap: 6px;
            }

            .loader-progress {
                width: 220px;
                height: 8px;
            }

            .loader-logo {
                font-size: 32px;
                margin-bottom: 25px;
            }
        }

        @media (max-height: 600px) {
            .game-content {
                padding-bottom: 100px;
            }
            
            .game-card {
                height: 30vh;
            }

            .game-timer {
                height: 50px;
                font-size: 20px;
                bottom: 10px;
            }
        }

        /* Очень маленькие экраны */
        @media (max-width: 320px) {
            .game-header {
                padding: 8px 10px;
                height: 50px;
            }

            .game-content {
                padding-top: 60px;
                padding-bottom: 100px;
            }

            .control-btn {
                width: 32px;
                height: 32px;
                font-size: 12px;
            }

            .game-score {
                font-size: 13px;
            }

            .game-timer {
                width: 35vw;
                height: 50px;
                font-size: 18px;
            }

            .category-grid {
                gap: 8px;
            }

            .category-btn {
                padding: 8px 6px;
                min-height: 65px;
            }
        }
    </style>
</head>
<body>
    <!-- Выпадающее меню звука -->
    <div class="sound-dropdown" id="soundDropdown">
        <button class="sound-dropdown-toggle" onclick="toggleSoundDropdown()">🔊</button>
        <div class="sound-dropdown-menu">
            <div class="sound-dropdown-item" onclick="toggleGlobalSound()">
                <span id="soundToggleIcon">🔊</span>
                <span id="soundToggleText">Вкл звук</span>
            </div>
            <div class="sound-dropdown-item" onclick="showSoundModal()">
                <span>⚙️</span>
                <span>Настройки</span>
            </div>
        </div>
    </div>

    <!-- Обновленный лоадер -->
    <div id="loader" class="loader">
        <div class="loader-logo">🎯 Alias Game</div>
        <div class="loader-progress">
            <div class="loader-progress-bar"></div>
        </div>
        <div class="loader-text">Загружается игра...</div>
    </div>

    <div class="container">
        <!-- Главное меню -->
        <div id="mainMenu" class="page">
            <h1>Alias Game</h1>
            <button class="menu-button" onclick="startNewGame()">🎮 Новая игра</button>
            <button class="menu-button" id="continueBtn" disabled>⏯️ Продолжить игру</button>
            <button class="menu-button" onclick="showPage('rules')">📖 Правила</button>
            <button class="menu-button" onclick="showPage('partnerTasks')">🎯 Задания от партнеров</button>
            
            <!-- Горизонтальное меню иконок -->
            <div class="bottom-menu">
                <div class="bottom-menu-item" onclick="showSoundModal()">
                    <div class="icon">🔊</div>
                    <div class="label">Звук</div>
                    <div class="tooltip">Настройки звука</div>
                </div>
                <div class="bottom-menu-item" onclick="showPage('dispace')">
                    <div class="icon">🚀</div>
                    <div class="label">DiSpace</div>
                    <div class="tooltip">О компании DiSpace</div>
                </div>
                <div class="bottom-menu-item" onclick="showPage('ratings')">
                    <div class="icon">🏆</div>
                    <div class="label">Рейтинги</div>
                    <div class="tooltip">Таблица лидеров</div>
                </div>
                <div class="bottom-menu-item" onclick="showPage('rewards')">
                    <div class="icon">🎁</div>
                    <div class="label">Награды</div>
                    <div class="tooltip">Мои достижения</div>
                </div>
            </div>
            
            <!-- О приложении внизу -->
            <div class="main-menu-about">
                <h3>О приложении</h3>
                <p>Alias Game - увлекательная командная игра, где нужно объяснять слова, не называя их напрямую.</p>
                <p>Играйте с друзьями, зарабатывайте награды и участвуйте в турнирах!</p>
                <p><strong>Версия:</strong> 2.1.0</p>
                <p><strong>Разработчик:</strong> © 2024 DiSpace</p>
            </div>
        </div>

        <!-- Настройка команд -->
        <div id="teamSetup" class="page">
            <div class="back-button" onclick="showPage('mainMenu')">← Назад</div>
            <h2>Настройка команд</h2>
            <div id="teamList" class="team-list"></div>
            <div class="add-team-btn" onclick="addTeam()">+</div>
            <button class="menu-button" onclick="showPage('categorySelect')">Далее →</button>
        </div>

        <!-- Выбор категорий -->
        <div id="categorySelect" class="page">
            <div class="back-button" onclick="showPage('teamSetup')">← Назад</div>
            <h2>Выбор категорий</h2>
            <div class="theme-warning" id="themeWarning">
                ⚠️ Выберите хотя бы одну тему для игры!
            </div>
            
            <h3>Сложность</h3>
            <div class="difficulty-selector">
                <button class="difficulty-btn" onclick="adjustDifficulty(-1)">−</button>
                <div class="difficulty-display">
                    <div class="difficulty-level" id="difficultyLevel">🟢</div>
                    <div class="difficulty-name" id="difficultyName">Легкий</div>
                    <div class="difficulty-desc" id="difficultyDesc">Простые слова</div>
                </div>
                <button class="difficulty-btn" onclick="adjustDifficulty(1)">+</button>
            </div>
            
            <h3>Темы</h3>
            <div class="category-grid">
                <button class="category-btn" data-type="theme" data-value="cities">
                    <div class="category-icon">🏙️</div>
                    <div>Города</div>
                    <div class="category-tooltip">Города мира</div>
                </button>
                <button class="category-btn" data-type="theme" data-value="capitals">
                    <div class="category-icon">🏛️</div>
                    <div>Столицы</div>
                    <div class="category-tooltip">Столицы стран</div>
                </button>
                <button class="category-btn" data-type="theme" data-value="general">
                    <div class="category-icon">📚</div>
                    <div>Общие слова</div>
                    <div class="category-tooltip">Разные темы</div>
                </button>
                <button class="category-btn" data-type="theme" data-value="harry_potter">
                    <div class="category-icon">⚡</div>
                    <div>Гарри Поттер</div>
                    <div class="category-tooltip">Мир магии</div>
                </button>
                <button class="category-btn" data-type="theme" data-value="lotr">
                    <div class="category-icon">💍</div>
                    <div>Властелин колец</div>
                    <div class="category-tooltip">Средиземье</div>
                </button>
                <button class="category-btn" data-type="theme" data-value="celebrities">
                    <div class="category-icon">⭐</div>
                    <div>Знаменитости</div>
                    <div class="category-tooltip">Известные люди</div>
                </button>
                <button class="category-btn" data-type="theme" data-value="tech">
                    <div class="category-icon">💻</div>
                    <div>Технологии</div>
                    <div class="category-tooltip">IT и гаджеты</div>
                </button>
                <button class="category-btn" data-type="theme" data-value="science">
                    <div class="category-icon">🔬</div>
                    <div>Наука</div>
                    <div class="category-tooltip">Научные термины</div>
                </button>
            </div>
            <button class="menu-button" onclick="proceedToGameSettings()">Далее →</button>
        </div>

        <!-- Настройки игры -->
        <div id="gameSettings" class="page">
            <div class="back-button" onclick="showPage('categorySelect')">← Назад</div>
            <h2>Настройки игры</h2>
            
            <div class="settings-group">
                <label>Время раунда</label>
                <div class="setting-control">
                    <button class="setting-btn" onclick="adjustSetting('roundTime', -10)">−</button>
                    <div class="setting-value" id="roundTimeValue">60 сек</div>
                    <button class="setting-btn" onclick="adjustSetting('roundTime', 10)">+</button>
                </div>
            </div>

            <div class="settings-group">
                <label>Минимальное количество очков для победы</label>
                <div class="setting-control">
                    <button class="setting-btn" onclick="adjustSetting('winScore', -5)">−</button>
                    <div class="setting-value" id="winScoreValue">30</div>
                    <button class="setting-btn" onclick="adjustSetting('winScore', 5)">+</button>
                </div>
            </div>

            <div class="settings-group">
                <label>Ставка (монеты)</label>
                <input type="range" class="bet-slider" id="betSlider" min="0" max="100" value="0" oninput="updateBetValue(this.value)">
                <div class="bet-value" id="betValue">0 монет</div>
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="skipPenalty">
                <label for="skipPenalty">Штраф за пропуск слова (-1 очко)</label>
            </div>

            <button class="menu-button" onclick="startGame()">🎮 Начать игру</button>
        </div>

        <!-- Игровой экран -->
        <div id="gameScreen" class="page game-screen">
            <!-- Фиксированная шапка -->
            <div class="game-header">
                <div class="game-score" id="headerScore">Очки: 0</div>
                <div class="game-controls">
                    <button class="control-btn" id="gameSoundToggle" onclick="toggleGameSound()">🔊</button>
                    <button class="control-btn" onclick="pauseGame()">⏸️</button>
                    <button class="control-btn" onclick="exitToMenu()">🏠</button>
                </div>
            </div>
            
            <!-- Контент игры -->
            <div class="game-content">
                <!-- Фоновые подсказки -->
                <div class="swipe-background">
                    <div class="swipe-bg-left" id="swipeBgLeft">❌ ПРОПУСТИТЬ</div>
                    <div class="swipe-bg-right" id="swipeBgRight">ОТГАДАНО ✅</div>
                </div>
                
                <div class="current-team" id="currentTeam">Команда 1</div>
                
                <div class="game-area">
                    <div class="game-card" id="gameCard">
                        <div class="swipe-indicators">
                            <div class="swipe-indicator left">❌</div>
                            <div class="swipe-indicator right">✅</div>
                        </div>
                        <span id="cardText">Готов?</span>
                    </div>
                    
                    <!-- Визуальные подсказки -->
                    <div class="swipe-hints" id="swipeHints">
                        <div class="swipe-hint ready">
                            <span>Свайп вправо →</span>
                            <span>Готов!</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Фиксированный таймер -->
            <div class="game-timer" id="gameTimer" style="display: none;">60</div>
        </div>

        <!-- Промежуточные результаты -->
        <div id="roundResults" class="page">
            <h2>Результаты раунда</h2>
            <div id="resultsList" class="results-list"></div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="correctCount">0</div>
                    <div class="stat-label">Угадано</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="incorrectCount">0</div>
                    <div class="stat-label">Пропущено</div>
                </div>
            </div>
            <button class="menu-button" onclick="nextRound()">Далее →</button>
        </div>

        <!-- Праздничные финальные результаты -->
        <div id="finalResults" class="page victory-page">
            <div class="victory-content">
                <h2 class="victory-title">🎉 Поздравляем! 🎉</h2>
                <h1 class="victory-winner" id="winnerName">Победитель</h1>
                <div class="victory-stats">
                    <div class="victory-stat">
                        <div class="victory-stat-value" id="finalScore">0</div>
                        <div class="victory-stat-label">Очков набрано</div>
                    </div>
                    <div class="victory-stat">
                        <div class="victory-stat-value" id="prizeAmount">0</div>
                        <div class="victory-stat-label">Призовой фонд</div>
                    </div>
                </div>
                <div class="qr-code">
                    <span>🎁 QR-код награды 🎁</span>
                </div>
                <button class="menu-button victory-button" onclick="showPage('mainMenu')">🏠 В главное меню</button>
            </div>
        </div>

        <!-- DiSpace -->
        <div id="dispace" class="page">
            <div class="back-button" onclick="showPage('mainMenu')">← Назад</div>
            <h2>DiSpace</h2>
            <p>DiSpace - цифровая экосистема для бизнеса и развлечений. Объединяем лучшие сервисы в единое пространство:</p>
            <ul style="margin: 20px; line-height: 2; padding-left: 20px;">
                <li>Digital Bar</li>
                <li>Game Bar</li>
                <li>Digital Hotel</li>
                <li>Digital Cafe</li>
                <li>Digital Trip</li>
                <li>Digital Music</li>
                <li>Digital Sharing</li>
                <li>Digital Health</li>
                <li>Digital Delivery</li>
            </ul>
        </div>

        <!-- Рейтинги -->
        <div id="ratings" class="page">
            <div class="back-button" onclick="showPage('mainMenu')">← Назад</div>
            <h2>Рейтинги</h2>
            <div id="ratingsList">
                <p>Рейтинги игроков будут отображаться здесь после первых игр.</p>
            </div>
        </div>

        <!-- Задания от партнеров -->
        <div id="partnerTasks" class="page">
            <div class="back-button" onclick="showPage('mainMenu')">← Назад</div>
            <h2>Задания от партнеров</h2>
            <p>Эксклюзивные сценарии игры от наших партнеров появятся здесь скоро!</p>
        </div>

        <!-- Награды -->
        <div id="rewards" class="page">
            <div class="back-button" onclick="showPage('mainMenu')">← Назад</div>
            <h2>Мои награды</h2>
            <p>Здесь будут отображаться ваши достижения и награды.</p>
        </div>

        <!-- Правила -->
        <div id="rules" class="page">
            <div class="back-button" onclick="showPage('mainMenu')">← Назад</div>
            <h2>Правила игры</h2>
            <p><strong>Цель игры:</strong> Объяснить как можно больше слов своей команде за отведенное время.</p>
            <p style="margin: 20px 0;"><strong>Как играть:</strong></p>
            <ol style="margin: 20px; line-height: 2; padding-left: 20px;">
                <li>Разделитесь на команды</li>
                <li>Выберите категории слов и сложность</li>
                <li>Объясняйте слова, не называя их и однокоренные слова</li>
                <li>Свайп вправо - слово угадано (+1 очко)</li>
                <li>Свайп влево - пропустить слово</li>
                <li>Побеждает команда, набравшая больше всех очков, но не менее установленного минимума</li>
            </ol>
        </div>

        <!-- Модальное окно для редактирования команды -->
        <div id="teamModal" class="modal">
            <div class="modal-content">
                <h3>Редактировать команду</h3>
                <input type="text" id="teamNameInput" placeholder="Название команды">
                <div class="modal-buttons">
                    <button class="save" onclick="saveTeamName()">Сохранить</button>
                    <button class="delete" onclick="deleteTeam()">Удалить</button>
                    <button class="cancel" onclick="closeModal()">Отмена</button>
                </div>
            </div>
        </div>

        <!-- Модальное окно паузы -->
        <div id="pauseModal" class="modal">
            <div class="modal-content">
                <h3>Игра приостановлена</h3>
                <button class="menu-button" onclick="resumeGame()">▶️ Продолжить</button>
                <button class="menu-button" onclick="exitToMenuConfirm()">🏠 В главное меню</button>
            </div>
        </div>

        <!-- Модальное окно настроек звука -->
        <div id="soundModal" class="modal sound-modal">
            <div class="modal-content">
                <h3>Настройки звука</h3>
                
                <div class="volume-control">
                    <label>Звуки свайпов:</label>
                    <input type="range" id="swipeVolume" min="0" max="100" value="60">
                    <span class="volume-value" id="swipeVolumeValue">60%</span>
                </div>

                <div class="volume-control">
                    <label>Звуки таймера:</label>
                    <input type="range" id="timerVolume" min="0" max="100" value="80">
                    <span class="volume-value" id="timerVolumeValue">80%</span>
                </div>

                <div class="modal-buttons">
                    <button class="menu-button" onclick="testSounds()">🔊 Тест звуков</button>
                    <button class="cancel" onclick="closeModal()">Готово</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Глобальные переменные
        let teams = [];
        let currentTeamIndex = 0;
        let currentWord = '';
        let timer = null;
        let timeLeft = 60;
        let gameWords = [];
        let usedWords = new Set();
        let roundWords = { correct: [], incorrect: [] };
        let gameSettings = {
            roundTime: 60,
            winScore: 30,
            skipPenalty: false,
            betAmount: 0,
            difficulty: 0
        };
        let currentEditingTeam = null;
        let isDragging = false;
        let startX = 0;
        let currentX = 0;
        let isPaused = false;
        let gameEnded = false;
        let gameStarted = false;
        let soundSettings = {
            swipe: 60,
            timer: 80,
            enabled: true
        };
        let soundDropdownOpen = false;

        // Креативные названия команд
        const randomTeamNames = [
            'Космические Единороги', 'Танцующие Роботы', 'Летающие Енеки', 'Магические Пингвины',
            'Сверкающие Драконы', 'Мудрые Совушки', 'Смелые Хомяки', 'Весёлые Панды',
            'Быстрые Лисички', 'Умные Кроты', 'Добрые Медведи', 'Храбрые Зайцы',
            'Озорные Белки', 'Мечтающие Слоны', 'Поющие Дельфины', 'Игривые Котики',
            'Радужные Бабочки', 'Солнечные Львы', 'Лунные Волки', 'Звёздные Тигры',
            'Изумрудные Ёжики', 'Золотые Орлы', 'Серебряные Акулы', 'Алмазные Фламинго',
            'Неоновые Жирафы', 'Плазменные Кенгуру', 'Лазерные Черепахи', 'Кибер Коалы'
        ];

        // Словари сложности
        const difficultyLevels = [
            { level: '🟢', name: 'Легкий', desc: 'Простые слова', value: 'easy' },
            { level: '🟡', name: 'Средний', desc: 'Обычная сложность', value: 'medium' },
            { level: '🟠', name: 'Сложный', desc: 'Сложные слова', value: 'hard' },
            { level: '🔴', name: 'Экстрим', desc: 'Очень сложно!', value: 'extreme' }
        ];

        // Расширенные словари слов
        const wordDictionaries = {
            easy: {
                general: ['стол', 'стул', 'дом', 'кот', 'собака', 'дерево', 'солнце', 'луна', 'вода', 'огонь', 'книга', 'ручка', 'телефон', 'компьютер', 'машина', 'автобус', 'поезд', 'самолет', 'корабль', 'велосипед', 'часы', 'зеркало', 'окно', 'дверь', 'стена', 'пол', 'потолок', 'крыша', 'лестница', 'лифт', 'магазин', 'школа', 'больница', 'театр', 'кино', 'парк', 'река', 'озеро', 'море', 'гора', 'лес', 'поле', 'сад', 'цветок', 'трава', 'листья', 'ветка', 'корень', 'камень'],
                cities: ['Москва', 'Санкт-Петербург', 'Новосибирск', 'Екатеринбург', 'Казань', 'Нижний Новгород', 'Челябинск', 'Самара', 'Омск', 'Ростов-на-Дону', 'Уфа', 'Красноярск', 'Воронеж', 'Пермь', 'Волгоград', 'Краснодар', 'Саратов', 'Тюмень', 'Тольятти', 'Ижевск'],
                capitals: ['Москва', 'Вашингтон', 'Лондон', 'Париж', 'Берлин', 'Рим', 'Мадрид', 'Лиссабон', 'Амстердам', 'Брюссель', 'Вена', 'Берн', 'Стокгольм', 'Осло', 'Копенгаген', 'Хельсинки', 'Варшава', 'Прага', 'Братислава', 'Будапешт'],
                tech: ['компьютер', 'телефон', 'смартфон', 'планшет', 'ноутбук', 'интернет', 'сайт', 'приложение', 'программа', 'код', 'клавиатура', 'мышь', 'монитор', 'экран', 'принтер', 'сканер', 'камера', 'микрофон', 'колонки', 'наушники']
            },
            medium: {
                general: ['абстракция', 'амбиция', 'анализ', 'аргумент', 'атмосфера', 'баланс', 'барьер', 'вдохновение', 'взаимодействие', 'влияние', 'воображение', 'восприятие', 'гармония', 'гипотеза', 'дилемма', 'дисциплина', 'достижение', 'единство', 'жертва', 'забота'],
                celebrities: ['Пушкин', 'Толстой', 'Достоевский', 'Чехов', 'Гоголь', 'Лермонтов', 'Тургенев', 'Некрасов', 'Крылов', 'Эйнштейн', 'Ньютон', 'Дарвин', 'Галилей', 'Коперник', 'Кеплер', 'Менделеев', 'Ломоносов', 'Павлов', 'Шекспир', 'Данте'],
                science: ['гравитация', 'эволюция', 'фотосинтез', 'атом', 'молекула', 'энергия', 'электричество', 'магнетизм', 'радиация', 'квант', 'фотон', 'электрон', 'протон', 'нейтрон', 'ядро', 'изотоп', 'элемент', 'соединение', 'реакция', 'катализ']
            },
            hard: {
                general: ['парадокс', 'абстракция', 'концепция', 'философия', 'метафора', 'аллегория', 'символизм', 'метонимия', 'синекдоха', 'оксюморон', 'антитеза', 'гипербола', 'литота', 'ирония', 'сарказм', 'эвфемизм'],
                harry_potter: ['Хогвартс', 'квиддич', 'патронус', 'крестраж', 'дементор', 'магл', 'волшебная палочка', 'Гриффиндор', 'Слизерин', 'Когтевран', 'Пуффендуй', 'Волдеморт', 'Дамблдор', 'Снейп', 'МакГонагалл', 'Хагрид'],
                lotr: ['Средиземье', 'хоббит', 'Гондор', 'Мордор', 'эльф', 'орк', 'Шир', 'Изенгард', 'Роhan', 'Минас Тирит', 'Минас Моргул', 'Барад-дур', 'Ортханк', 'Эдорас', 'Хельмова Падь', 'Фангорн']
            },
            extreme: {
                general: ['экзистенциализм', 'феноменология', 'герменевтика', 'эпистемология', 'онтология', 'гносеология', 'аксиология', 'дискурс', 'парадигма', 'синергетика'],
                harry_potter: ['Авада Кедавра', 'Экспеллиармус', 'Экспекто Патронум', 'Турнир Трех Волшебников', 'Кубок Огня', 'Золотой Снитч', 'Квафл', 'Бладжер', 'Мародерская карта', 'Тайная комната'],
                lotr: ['Эльронд', 'Галадриэль', 'Саурон', 'Сарумон', 'Леголас', 'Гимли', 'Боромир', 'Арагорн', 'Фродо', 'Сэм']
            }
        };

        // Звуковые эффекты
        function playTone(frequency, duration, volume = 50) {
            if (!soundSettings.enabled) return;
            
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = frequency;
                oscillator.type = 'sine';
                
                const finalVolume = (volume / 100) * 0.1;
                
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(finalVolume, audioContext.currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration / 1000);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration / 1000);
            } catch (e) {
                console.warn('Не удалось воспроизвести звук:', e);
            }
        }

        // Звуковые функции
        function playSwipeSound(isCorrect) {
            const frequency = isCorrect ? 440 : 165;  // Правильно = 440Hz, Пропуск = 165Hz
            playTone(frequency, 200, soundSettings.swipe);
        }

        function playTimerSound() {
            playTone(880, 100, soundSettings.timer);
        }

        function playCountdownSound() {
            playTone(330, 300, soundSettings.timer);
        }

        // Инициализация
        function init() {
            setTimeout(() => {
                document.getElementById('loader').style.display = 'none';
                document.getElementById('mainMenu').classList.add('active');
            }, 3000);

            loadSoundSettings();

            teams = [
                { name: getRandomTeamName(), score: 0 },
                { name: getRandomTeamName(), score: 0 }
            ];
            renderTeams();

            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', toggleCategory);
            });

            setupCardSwipe();
            setupSoundControls();
            updateSoundDropdown();
            initGameSettings();
            initDifficultySelector();

            document.addEventListener('click', (e) => {
                if (!e.target.closest('.sound-dropdown')) {
                    closeSoundDropdown();
                }
            });
        }

        function getRandomTeamName() {
            let usedNames = teams.map(team => team.name);
            let availableNames = randomTeamNames.filter(name => !usedNames.includes(name));
            if (availableNames.length === 0) availableNames = randomTeamNames;
            return availableNames[Math.floor(Math.random() * availableNames.length)];
        }

        function toggleSoundDropdown() {
            const dropdown = document.getElementById('soundDropdown');
            soundDropdownOpen = !soundDropdownOpen;
            
            if (soundDropdownOpen) {
                dropdown.classList.add('active');
            } else {
                dropdown.classList.remove('active');
            }
        }

        function closeSoundDropdown() {
            document.getElementById('soundDropdown').classList.remove('active');
            soundDropdownOpen = false;
        }

        function updateSoundDropdown() {
            const toggle = document.querySelector('.sound-dropdown-toggle');
            const icon = document.getElementById('soundToggleIcon');
            const text = document.getElementById('soundToggleText');
            const item = document.querySelector('.sound-dropdown-item');
            
            if (soundSettings.enabled) {
                toggle.textContent = '🔊';
                icon.textContent = '🔇';
                text.textContent = 'Выкл звук';
                item.classList.remove('active');
            } else {
                toggle.textContent = '🔇';
                icon.textContent = '🔊';
                text.textContent = 'Вкл звук';
                item.classList.add('active');
            }
        }

        function loadSoundSettings() {
            const saved = localStorage.getItem('aliasSound');
            if (saved) {
                soundSettings = {...soundSettings, ...JSON.parse(saved)};
                updateSoundUI();
            }
        }

        function saveSoundSettings() {
            localStorage.setItem('aliasSound', JSON.stringify(soundSettings));
            updateSoundDropdown();
        }

        function setupSoundControls() {
            const controls = ['swipe', 'timer'];
            controls.forEach(type => {
                const slider = document.getElementById(`${type}Volume`);
                const value = document.getElementById(`${type}VolumeValue`);
                
                if (slider && value) {
                    slider.value = soundSettings[type];
                    value.textContent = slider.value + '%';
                    
                    slider.addEventListener('input', (e) => {
                        const val = e.target.value;
                        soundSettings[type] = parseInt(val);
                        value.textContent = val + '%';
                        saveSoundSettings();
                    });
                }
            });
        }

        function updateSoundUI() {
            const controls = ['swipe', 'timer'];
            controls.forEach(type => {
                const slider = document.getElementById(`${type}Volume`);
                const value = document.getElementById(`${type}VolumeValue`);
                
                if (slider && value) {
                    slider.value = soundSettings[type];
                    value.textContent = soundSettings[type] + '%';
                }
            });
        }

        function toggleGlobalSound() {
            soundSettings.enabled = !soundSettings.enabled;
            saveSoundSettings();
            updateSoundDropdown();
            closeSoundDropdown();
        }

        function toggleGameSound() {
            soundSettings.enabled = !soundSettings.enabled;
            saveSoundSettings();
            updateSoundDropdown();
        }

        function showSoundModal() {
            closeSoundDropdown();
            document.getElementById('soundModal').classList.add('active');
        }

        function testSounds() {
            setTimeout(() => playSwipeSound(true), 100);
            setTimeout(() => playSwipeSound(false), 600);
            setTimeout(() => playTimerSound(), 1200);
            setTimeout(() => playCountdownSound(), 1800);
        }

        function initGameSettings() {
            updateSettingDisplay('roundTime', gameSettings.roundTime + ' сек');
            updateSettingDisplay('winScore', gameSettings.winScore);
            updateBetValue(gameSettings.betAmount);
        }

        function initDifficultySelector() {
            updateDifficultyDisplay();
        }

        function updateDifficultyDisplay() {
            const currentDiff = difficultyLevels[gameSettings.difficulty];
            document.getElementById('difficultyLevel').textContent = currentDiff.level;
            document.getElementById('difficultyName').textContent = currentDiff.name;
            document.getElementById('difficultyDesc').textContent = currentDiff.desc;
        }

        function adjustDifficulty(delta) {
            gameSettings.difficulty = Math.max(0, Math.min(difficultyLevels.length - 1, gameSettings.difficulty + delta));
            updateDifficultyDisplay();
        }

        function updateSettingDisplay(setting, value) {
            document.getElementById(setting + 'Value').textContent = value;
        }

        function adjustSetting(setting, delta) {
            if (setting === 'roundTime') {
                gameSettings.roundTime = Math.max(30, Math.min(180, gameSettings.roundTime + delta));
                updateSettingDisplay('roundTime', gameSettings.roundTime + ' сек');
            } else if (setting === 'winScore') {
                gameSettings.winScore = Math.max(10, Math.min(100, gameSettings.winScore + delta));
                updateSettingDisplay('winScore', gameSettings.winScore);
            }
        }

        function updateBetValue(value) {
            gameSettings.betAmount = parseInt(value);
            document.getElementById('betValue').textContent = value + ' монет';
        }

        function showPage(pageId) {
            closeSoundDropdown();
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            const soundDropdown = document.getElementById('soundDropdown');
            if (pageId === 'gameScreen') {
                soundDropdown.style.display = 'none';
            } else {
                soundDropdown.style.display = 'block';
            }
        }

        function startNewGame() {
            gameEnded = false;
            gameStarted = false;
            usedWords.clear();
            teams = [
                { name: getRandomTeamName(), score: 0 },
                { name: getRandomTeamName(), score: 0 }
            ];
            renderTeams();
            showPage('teamSetup');
        }

        function renderTeams() {
            const teamList = document.getElementById('teamList');
            teamList.innerHTML = '';
            
            teams.forEach((team, index) => {
                const teamItem = document.createElement('div');
                teamItem.className = 'team-item';
                teamItem.innerHTML = `
                    <span class="team-name">${team.name}</span>
                    <span class="team-score">${team.score}</span>
                `;
                teamItem.onclick = () => editTeam(index);
                teamList.appendChild(teamItem);
            });
        }

        function addTeam() {
            if (teams.length >= 10) {
                alert('Максимум 10 команд!');
                return;
            }
            
            teams.push({ name: getRandomTeamName(), score: 0 });
            renderTeams();
        }

        function editTeam(index) {
            currentEditingTeam = index;
            document.getElementById('teamNameInput').value = teams[index].name;
            document.getElementById('teamModal').classList.add('active');
        }

        function saveTeamName() {
            const newName = document.getElementById('teamNameInput').value.trim();
            if (newName) {
                teams[currentEditingTeam].name = newName;
                renderTeams();
            }
            closeModal();
        }

        function deleteTeam() {
            if (teams.length > 2) {
                teams.splice(currentEditingTeam, 1);
                renderTeams();
            } else {
                alert('Минимум 2 команды!');
            }
            closeModal();
        }

        function closeModal() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.remove('active');
            });
        }

        function toggleCategory(e) {
            const btn = e.target.closest('.category-btn');
            btn.classList.toggle('selected');
            
            const selectedThemes = document.querySelectorAll('[data-type="theme"].selected');
            const warning = document.getElementById('themeWarning');
            if (selectedThemes.length > 0) {
                warning.classList.remove('show');
            }
        }

        function proceedToGameSettings() {
            const selectedThemes = document.querySelectorAll('[data-type="theme"].selected');
            const warning = document.getElementById('themeWarning');
            
            if (selectedThemes.length === 0) {
                warning.classList.add('show');
                warning.scrollIntoView({ behavior: 'smooth', block: 'center' });
                return;
            }
            
            showPage('gameSettings');
        }

        function startGame() {
            gameSettings.skipPenalty = document.getElementById('skipPenalty').checked;
            gameSettings.betAmount = parseInt(document.getElementById('betSlider').value);

            prepareGameWords();
            
            teams.forEach(team => team.score = 0);
            currentTeamIndex = 0;
            gameEnded = false;
            gameStarted = false;
            usedWords.clear();
            
            showPage('gameScreen');
            prepareRound();
        }

        function prepareGameWords() {
            gameWords = [];
            
            const difficulty = difficultyLevels[gameSettings.difficulty].value;
            
            const selectedThemes = Array.from(document.querySelectorAll('[data-type="theme"].selected'))
                .map(btn => btn.dataset.value);
            
            selectedThemes.forEach(theme => {
                if (wordDictionaries[difficulty] && wordDictionaries[difficulty][theme]) {
                    gameWords.push(...wordDictionaries[difficulty][theme]);
                }
            });
            
            gameWords.sort(() => Math.random() - 0.5);
        }

        function prepareRound() {
            const currentTeam = teams[currentTeamIndex];
            document.getElementById('currentTeam').textContent = currentTeam.name;
            document.getElementById('headerScore').textContent = `Очки: ${currentTeam.score}`;
            document.getElementById('cardText').textContent = 'Готов?';
            
            roundWords = { correct: [], incorrect: [] };
            timeLeft = gameSettings.roundTime;
            gameStarted = false;
            
            // Скрываем таймер до начала игры
            document.getElementById('gameTimer').style.display = 'none';
            
            // Показываем подсказку готовности
            const hints = document.getElementById('swipeHints');
            hints.innerHTML = `
                <div class="swipe-hint ready">
                    <span>Свайп вправо →</span>
                    <span>Готов!</span>
                </div>
            `;
            
            waitForReady();
        }

        function waitForReady() {
            const card = document.getElementById('gameCard');
            card.dataset.mode = 'ready';
        }

        function startCountdown() {
            // Обратный отсчет 3, 2, 1, Поехали!
            let countdown = 3;
            const card = document.getElementById('gameCard');
            card.dataset.mode = 'countdown';
            card.classList.add('countdown');
            
            // Показываем таймер
            document.getElementById('gameTimer').style.display = 'flex';
            document.getElementById('gameTimer').textContent = gameSettings.roundTime;
            
            // Обновляем подсказки
            const hints = document.getElementById('swipeHints');
            hints.innerHTML = `
                <div class="swipe-hint left">
                    <span>←</span>
                    <span>Пропустить</span>
                </div>
                <div class="swipe-hint right">
                    <span>Отгадано</span>
                    <span>→</span>
                </div>
            `;
            
            const countdownTexts = ['3', '2', '1', 'Поехали!'];
            
            const countdownInterval = setInterval(() => {
                if (countdown >= 0) {
                    document.getElementById('cardText').textContent = countdownTexts[3 - countdown];
                    playCountdownSound();
                    countdown--;
                } else {
                    clearInterval(countdownInterval);
                    card.dataset.mode = 'game';
                    card.classList.remove('countdown');
                    gameStarted = true;
                    showNextWord();
                    startTimer();
                }
            }, 1000);
        }

        function showNextWord() {
            const availableWords = gameWords.filter(word => !usedWords.has(word));
            
            if (availableWords.length === 0) {
                usedWords.clear();
                prepareGameWords();
                return showNextWord();
            }
            
            const randomIndex = Math.floor(Math.random() * availableWords.length);
            currentWord = availableWords[randomIndex];
            usedWords.add(currentWord);
            
            document.getElementById('cardText').textContent = currentWord;
        }

        function handleWordResult(isCorrect) {
            if (!gameStarted) return;
            
            const currentTeam = teams[currentTeamIndex];
            
            if (isCorrect) {
                currentTeam.score++;
                roundWords.correct.push(currentWord);
            } else {
                if (gameSettings.skipPenalty) {
                    currentTeam.score = Math.max(0, currentTeam.score - 1);
                }
                roundWords.incorrect.push(currentWord);
            }
            
            playSwipeSound(isCorrect);
            document.getElementById('headerScore').textContent = `Очки: ${currentTeam.score}`;
            showNextWord();
        }

        function startTimer() {
            timer = setInterval(() => {
                timeLeft--;
                document.getElementById('gameTimer').textContent = timeLeft;
                
                if (timeLeft <= 10 && timeLeft > 0) {
                    playTimerSound();
                    document.getElementById('gameTimer').classList.add('warning');
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    endRound();
                }
            }, 1000);
        }

        function pauseGame() {
            if (timer && gameStarted) {
                clearInterval(timer);
                isPaused = true;
                document.getElementById('pauseModal').classList.add('active');
            }
        }

        function resumeGame() {
            isPaused = false;
            closeModal();
            if (timeLeft > 0 && !gameEnded && gameStarted) {
                startTimer();
            }
        }

        function exitToMenu() {
            document.getElementById('pauseModal').classList.add('active');
        }

        function exitToMenuConfirm() {
            clearInterval(timer);
            isPaused = false;
            gameEnded = true;
            gameStarted = false;
            closeModal();
            showPage('mainMenu');
        }

        function endRound() {
            clearInterval(timer);
            gameStarted = false;
            document.getElementById('gameTimer').classList.remove('warning');
            showRoundResults();
        }

        function showRoundResults() {
            showPage('roundResults');
            
            const resultsList = document.getElementById('resultsList');
            resultsList.innerHTML = '';
            
            roundWords.correct.forEach((word, index) => {
                const wordDiv = document.createElement('div');
                wordDiv.className = 'word-result correct';
                wordDiv.innerHTML = `<span>${word}</span><span>+1</span>`;
                wordDiv.onclick = () => toggleWordResult(word, index, true);
                resultsList.appendChild(wordDiv);
            });
            
            roundWords.incorrect.forEach((word, index) => {
                const wordDiv = document.createElement('div');
                wordDiv.className = 'word-result incorrect';
                const penalty = gameSettings.skipPenalty ? '-1' : '0';
                wordDiv.innerHTML = `<span>${word}</span><span>${penalty}</span>`;
                wordDiv.onclick = () => toggleWordResult(word, index, false);
                resultsList.appendChild(wordDiv);
            });
            
            document.getElementById('correctCount').textContent = roundWords.correct.length;
            document.getElementById('incorrectCount').textContent = roundWords.incorrect.length;
        }

        function toggleWordResult(word, index, wasCorrect) {
            const currentTeam = teams[currentTeamIndex];
            
            if (wasCorrect) {
                roundWords.correct.splice(index, 1);
                roundWords.incorrect.push(word);
                currentTeam.score--;
                if (gameSettings.skipPenalty) {
                    currentTeam.score = Math.max(0, currentTeam.score - 1);
                }
            } else {
                roundWords.incorrect.splice(index, 1);
                roundWords.correct.push(word);
                currentTeam.score++;
                if (gameSettings.skipPenalty) {
                    currentTeam.score++;
                }
            }
            
            showRoundResults();
        }

        function nextRound() {
            currentTeamIndex = (currentTeamIndex + 1) % teams.length;
            
            if (currentTeamIndex === 0) {
                checkForWinner();
            } else {
                showPage('gameScreen');
                prepareRound();
            }
        }

        function checkForWinner() {
            const maxScore = Math.max(...teams.map(team => team.score));
            const teamsWithMaxScore = teams.filter(team => team.score === maxScore);
            
            if (maxScore >= gameSettings.winScore && teamsWithMaxScore.length === 1) {
                endGame();
            } else {
                showPage('gameScreen');
                prepareRound();
            }
        }

        function endGame() {
            clearInterval(timer);
            gameEnded = true;
            gameStarted = false;
            
            const maxScore = Math.max(...teams.map(team => team.score));
            const winners = teams.filter(team => team.score === maxScore);
            
            if (winners.length === 1) {
                const winner = winners[0];
                document.getElementById('winnerName').textContent = winner.name;
                document.getElementById('finalScore').textContent = winner.score;
            } else {
                document.getElementById('winnerName').textContent = 'Ничья!';
                document.getElementById('finalScore').textContent = maxScore;
            }
            
            const prizePool = gameSettings.betAmount * teams.length;
            document.getElementById('prizeAmount').textContent = prizePool;
            
            showPage('finalResults');
            
            saveGameStats(winners.length === 1 ? winners[0] : null);
        }

        function saveGameStats(winner) {
            const stats = JSON.parse(localStorage.getItem('aliasStats') || '[]');
            stats.push({
                date: new Date().toISOString(),
                winner: winner ? winner.name : 'Ничья',
                score: winner ? winner.score : Math.max(...teams.map(team => team.score)),
                teams: teams.map(t => ({ name: t.name, score: t.score }))
            });
            localStorage.setItem('aliasStats', JSON.stringify(stats));
        }

        function setupCardSwipe() {
            const card = document.getElementById('gameCard');
            const leftIndicator = document.querySelector('.swipe-indicator.left');
            const rightIndicator = document.querySelector('.swipe-indicator.right');
            const swipeBgLeft = document.getElementById('swipeBgLeft');
            const swipeBgRight = document.getElementById('swipeBgRight');
            
            card.addEventListener('mousedown', startDrag);
            card.addEventListener('touchstart', startDrag, { passive: false });
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag, { passive: false });
            
            document.addEventListener('mouseup', endDrag);
            document.addEventListener('touchend', endDrag);
            
            function startDrag(e) {
                e.preventDefault();
                isDragging = true;
                startX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                card.classList.add('dragging');
            }
            
            function drag(e) {
                if (!isDragging) return;
                
                e.preventDefault();
                currentX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                const deltaX = currentX - startX;
                
                card.style.transform = `translateX(${deltaX}px) rotate(${deltaX * 0.1}deg)`;
                
                if (deltaX < -50) {
                    leftIndicator.classList.add('active');
                    rightIndicator.classList.remove('active');
                    swipeBgLeft.classList.add('active');
                    swipeBgRight.classList.remove('active');
                } else if (deltaX > 50) {
                    rightIndicator.classList.add('active');
                    leftIndicator.classList.remove('active');
                    swipeBgRight.classList.add('active');
                    swipeBgLeft.classList.remove('active');
                } else {
                    leftIndicator.classList.remove('active');
                    rightIndicator.classList.remove('active');
                    swipeBgLeft.classList.remove('active');
                    swipeBgRight.classList.remove('active');
                }
            }
            
            function endDrag(e) {
                if (!isDragging) return;
                
                isDragging = false;
                card.classList.remove('dragging');
                
                const deltaX = currentX - startX;
                const mode = card.dataset.mode;
                
                if (Math.abs(deltaX) > 100) {
                    if (mode === 'ready' && deltaX > 0) {
                        startCountdown();
                    } else if (mode === 'game' && gameStarted && !gameEnded) {
                        handleWordResult(deltaX > 0);
                    }
                }
                
                card.style.transform = '';
                leftIndicator.classList.remove('active');
                rightIndicator.classList.remove('active');
                swipeBgLeft.classList.remove('active');
                swipeBgRight.classList.remove('active');
            }
        }

        window.addEventListener('DOMContentLoaded', init);
        
        document.addEventListener('touchmove', function(e) {
            if (e.target.closest('.game-card')) {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>
